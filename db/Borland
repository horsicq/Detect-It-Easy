// Borland Delphi tests for Borland C++ first, so ensure we only do it once.

var bBorlandC;
if(typeof bBorlandC==="undefined")
{
    bBorlandC=0;
    if(PE.compare("'MZ'50000200000004000F00FFFF0000B80000000000000040001A00000000000000000000000000000000000000000000000000000000000000000000020000BA10000E1FB409CD21B8014CCD219090'This program must be run under Win32\r\n$'370000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'PE'0000"))
    {
        bBorlandC=1;
    }
    else if(PE.compareEP("A1........C1E002A3"))
    {
        bBorlandC=1;
    }
    else if(PE.compareEP("EB10'fb:C++HOOK'90"))
    {
        bBorlandC=2;
    }
    else if(PE.section.length>1)
    {
        var nOffset=PE.section[1].FileOffset;
        var nSize=Math.min(1024,PE.section[1].FileSize);
        if(PE.isSignaturePresent(nOffset,nSize,"'Borland C++ - Copyright'"))
        {
            bBorlandC=1;
        }
    }
}
