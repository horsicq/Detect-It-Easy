const PE_Cached={},logType={warning:-2,about:-1,nothing:0,any:1,net:2},heurLabel="HEUR"
var lastOffsetDetected="0x00"
function detect(){return stubForWrongEnvironment()||stubForLegacyEngines()?null:main()}function main(){initializeCache(),PE.isHeuristicScan()?(PE.isVerbose()||log(logType.warning,'To get the full heuristic scan result use "--verbose"'),log(logType.about,"Generic Heuristic Analysis by DosX (@DosX_dev)"),log(logType.nothing,"Scanning has begun!"),(PE_Cached.isDotNet?(scanForObfuscations_NET(),scanForAntiAnalysis_NET):scanForObfuscations_Native)(),scanForPackersAndCryptors_NET_and_Native(),scanForLicensingSystems_NET_and_Native(),scanForBadFileFormat_NET_and_Native(),scanForDebugData_NET_and_Native(),scanForMaliciousCode_NET_and_Native(),PE.isVerbose()&&scanForLanguagesAndCompilers_NET_and_Native(),log(logType.nothing,"Scan completed.")):log(logType.warning,"Heuristic scan is disabled. Use '--heuristicscan' to enable"),unloadCache()}function stubForLegacyEngines(){return void 0===PE.getNetAssemblyName&&(stdout(">>> Update DIE Engine to 3.20 and higher for using Heuristic-analyzer by DosX <<<"),!0)}function stubForWrongEnvironment(){return"undefined"==typeof PE?(stdout(">>> Wrong environment! 'PE' is undefined. Check DIE-engine for correct installation <<<"),!0):(PE.isHeuristicScan()&&PE.isVerbose()&&!_getNumberOfResults("operation system")&&stdout(">>> Script is running outside the environment! Are you in debug mode? <<<"),!1)}function stdout(e){if("object"==typeof console)console.warn(e)
else if("object"==typeof File)_setResult("~warning",e,"","")
else{if("function"!=typeof _error)throw e
_error(e)}}function initializeCache(){var e,t={isArchX86:isArchX86,isCppClrLikeApp:isCppClrLikeApp,isVbNetStandardLibraryPresent:isVbNetStandardLibraryPresent,isJscriptNetStandardLibraryPresent:isJscriptNetStandardLibraryPresent,firstEpAsmInstruction:getFirstEpAsmInstruction,is64bit:PE.is64,isDotNet:PE.isNet,isDynamicLinkLibrary:PE.isDll,isNetGlobalCctorPresent:PE.isNetGlobalCctorPresent,isRichSignaturePresent:PE.isRichSignaturePresent,numberOfSections:PE.getNumberOfSections,numberOfRichIDs:PE.getNumberOfRichIDs,numberOfUnmanagedResources:PE.getNumberOfResources,numberOfUnmanagedImports:PE.getNumberOfImports,numberOfUnmanagedExports:PE.getNumberOfExports,indexOfImportsSection:PE.getImportSection,indexOfExportsSection:PE.getExportSection,nameOfNetAssemblyName:PE.getNetAssemblyName,nameOfNetModuleName:PE.getNetModuleName}
for(e in t){var i=t[e]
i?PE_Cached[e]=i():stdout(">>> PE API function '"+e+"' is undefined! <<<")}}function unloadCache(){PE_Cached=void 0}function scanForObfuscations_NET(){log(logType.nothing,"Scanning for obfuscation...")
var e="",t=!1,i=!1,i=(PE_Cached.isDynamicLinkLibrary||(PE_Cached.isVbNetStandardLibraryPresent?isAllNetReferencesMissing(["Main","main","MAIN","MyApplication"])&&(i=!0):isAllNetReferencesMissing(["Main","main","main@","<Main>$","mainCRTStartup","wWinMainCRTStartup","_WinMainCRTStartup"])&&(i=!0),i&&log(logType.net,'No "Main" method found')),i&&(e="Modified managed EP"),!1),n=(!PE_Cached.isNetGlobalCctorPresent||PE_Cached.isCppClrLikeApp||isUnpackagedWindowsAppSdkLinked()||(log(logType.net,"Global constructor detected!"),i=!0),i&&(e=addOption(e,"CLR constructor")),!1),r=["~","Strings","US","GUID","Blob"]
if(!PE_Cached.isDynamicLinkLibrary&&1<PE_Cached.numberOfSections&&!PE_Cached.isCppClrLikeApp)for(var s=0;s<r.length;s++)if(!PE.isSignatureInSectionPresent(0,"00'#"+r[s]+"'00")){n=!0
break}n&&(e=addOption(e,"Strange EP position"))
var i=!1,i=(PE_Cached.isDynamicLinkLibrary||PE_Cached.isCppClrLikeApp||(!PE_Cached.is64bit&&PE_Cached.isArchX86?"JMP"!==getFirstEpAsmOpCode()&&(-1!==PE.VAToOffset(PE.getAddressOfEntryPoint())?log(logType.net,"Very strange EP pattern: "+getEpAsmPattern(!0,4).split("|").join(" .. ")):log(logType.net,"No native entry point"),i=!0):0!==PE.VAToOffset(PE.getAddressOfEntryPoint())&&(i=!0)),i&&(e=addOption(e,"Modified native EP")),!1),i=(-1===PE.findSignature(PE.getDosStubOffset(),PE.getDosStubSize(),"'This program cannot be run in DOS mode.'")&&(log(logType.net,"DOS-stub modified!"),i=!0),i&&(e=addOption(e,"Modified DOS")),!1),o=(1===PE_Cached.numberOfSections&&(log(logType.net,"Only one section found!"),i=!0),i&&(e=addOption(e,"Only one section")),!1),a="_-=+~!@#$%^&*()\"â„–;%:?*():;,/\\|'`<>.0123456789"
if(PE_Cached.numberOfSections>(PE_Cached.isCppClrLikeApp?10:6)||!PE.section[".text"])o=!0
else for(var l=0;l<PE_Cached.numberOfSections&&!o;l++){var d=PE.getSectionName(l)
if("."!==d[0]&&d.length<3){o=!0
break}for(var c=0;c<a.length&&!o;c++)-1!==d.substr(1,d.length).indexOf(a[c])&&(o=!0)
isAsciiString(d)||(o=o||!0)}o&&(e=addOption(e,"Strange sections"))
for(var u=!1,l=0;l<PE_Cached.numberOfUnmanagedResources&&!u;l++){var g=PE.getResourceNameByNumber(l)
!g||isAsciiString(g)&&!isNameObfuscated(g)||(log(logType.net,"Strange unmanaged resource name: "+g),u=!0)}u&&(e=addOption(e,"Strange unmanaged resources"))
var i=!1,P=((i=10<PE_Cached.numberOfSections?!0:i)&&(e=addOption(e,"Too many sections")),new NetOpCodes),i=!1,p=P.ldc_i4+P.ldc_i4+P.xor+P.ldc_i4,p=(validateNetByteCode(p)&&(validateNetByteCode(p+(P.setStrict(P.bne_un_s,"09")+P.ldc_i4_2+P.stloc_0+P.sizeof+P.add))||validateNetByteCode(p+(P.bne_un+P.ldc_i4+P.stloc+P.sizeof+P.add))||validateNetByteCode(p+(P.bne_un+P.ldc_i4_2+P.stloc_s+P.sizeof+P.add)))&&(log(logType.net,"Int confusion detected! Offset: "+lastOffsetDetected),i=!0),i&&(e=addOption(e,"Int confusion")),!1),i=(isAllNetReferencesPresent(["System.Reflection","GetILGenerator","BeginInvoke","EndInvoke","OpCode"])&&(validateNetObject("Ldarg_0")||validateNetObject("CreateDelegate"))&&!isFrameworkComponent()&&(log(logType.net,"Virtualization-like behavior detected!"),p=!0),p&&(e=addOption(e,"Virtualization")),!1),p=((i=isAllNetReferencesPresent(["GetTypeFromHandle","BinaryReader","CreateDelegate","MakeByRefType","DynamicMethod"])&&!isFrameworkComponent()?!0:i)&&(e=addOption(e,"Calls encrypt")),!1),i=((p=validateNetObject("SuppressIldasmAttribute")?!0:p)&&(e=addOption(e,"Anti-ILDASM")),!1),p=((validateSignature("'Form'******00'Form'******00'Form'******00")||validateNetObject("Form0"))&&(log(logType.net,"File may be protected by de4dot!"),i=!0),i&&(e=addOption(e,"Anti-de4dot")),!1),i=((validateNetByteCode(P.setStrict(P.ldftn,"** ?? 00 0A")+P.setStrict(P.calli,"** 00 00 11"))||validateNetByteCode(P.ldelem_i+P.setStrict(P.calli,"** 00 00 11")))&&(log(logType.net,"Calli invokes detected! Offset: "+lastOffsetDetected),p=!0),p&&(e=addOption(e,"Calli invokes")),!1),p=((validateNetByteCode(P.nop+P.setStrict(P.ldftn,"** 00 00 06")+P.stelem_i)||validateNetByteCode(P.nop+P.setStrict(P.ldftn,"** 00 00 0A")+P.stelem_i)||validateNetByteCode(P.setStrict(P.ldftn,"** 00 00 0A")+P.setStrict(P.calli,"** 00 00 11")))&&(log(logType.net,"Ldftn pointers method-obfuscation detected! Offset: "+lastOffsetDetected),i=!0),i&&(e=addOption(e,"Ldftn pointers")),!1),E=((validateNetByteCode(P.nop+P.ldloc_0+P.ldc_i4+P.mul+P.ldc_i4+P.xor+P.br_s+P.nop+P.ldloc_0+P.ldc_i4+P.mul+P.ldc_i4+P.xor+P.br_s)||validateNetByteCode(P.ldc_i4+P.ldc_i4+P.xor+P.dup+P.stloc_0+P.ldc_i4_3+P.rem_un+P.switch__nobody)||validateNetByteCode(P.setStrict(P.ldc_i4,"00 00 00 00")+P.br+P.br+P.ldloc)||validateNetByteCode(P.ldsfld+P.brfalse+P.pop+P.setStrict(P.ldc_i4,"01 00 00 00")+P.br+P.nop)||validateNetByteCode(P.setNullValue(P.ldc_i4)+P.ldsfld+P.brtrue+P.pop+P.ldc_i4+P.br)||validateNetByteCode(P.stloc+P.ldloc+P.joinNoBodyAndValue(P.switch__nobody,"** ** ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 00 00","switch__nobody")+P.ldc_i4+P.br)||validateNetByteCode(P.ldc_i4_3+P.joinNoBodyAndValue(P.switch__nobody,"01 00 00 00 F6 FF FF FF")+P.ldc_i4_1+P.brtrue_s+P.ldtoken+P.pop)||validateNetByteCode(P.setNullValue(P.ldc_i4)+P.stloc+P.br+P.nop+P.ldloc+P.setStrict(P.ldc_i4,"01 00 00 00")+P.ceq+P.brfalse)||validateNetByteCode(P.setNullValue(P.ldc_i4)+P.stloc+P.br+P.nop+P.ldloc+P.ldc_i4+P.ceq+P.brfalse)||validateNetByteCode(P.ldc_i4+P.br+P.ldloc_s+P.ldc_i4_s+P.ldc_i4_0+P.stelem_i1+P.ldc_i4+P.br)||validateNetByteCode(P.ldc_i4+P.ldc_i4+P._unknown+P.ldc_i4+P._unknown+P.stloc_0+P.nop+P.ldloc_0+P.ldc_i4+P.ldc_i4+P._unknown+P.ldc_i4+P._unknown+P.ceq+P.brfalse_s)||validateNetByteCode(P.setStrict(P.stloc_s,"05")+P.nop+P.ldloc_s+P._unknown+P.ceq+P.brfalse_s+P._unknown+P.setStrict(P.stloc_s,"05")+P.nop+P.ldloc_s+P._unknown+P.ceq+P.brfalse_s)||validateNetByteCode(P.ldloc_0+P.setStrict(P.ldc_i4,"?? ** ** **")+P._unknown+P.stloc_0+P.ldloc_0+P.setStrict(P.ldc_i4,"?? ** ** **")+P.xor+P.stloc_0)||validateNetByteCode(P.setStrict(P.ldc_i4,"?? ** ** **")+P._unknown+P.stloc_0+P.setStrict(P.ldftn,"** ?? ?? ??")))&&(log(logType.net,"Control flow obfuscation detected! Offset: "+lastOffsetDetected),p=!0),p&&(e=addOption(e,"Ctrl flow")),PE.findSignature(PE.getDosStubOffset()+PE.getDosStubSize(),PE.getSize()-PE.getOverlaySize(),"'<Module>'00**")+8),m=!1
if((PE.compare("00**00**00",E)||PE.compare("00****00****00****00",E)||PE.compare("00******00******00******00",E)||PE.compare("00********00********00********00",E)||PE.compare("00****00****00",E)||PE.compare("00****00**00",E)||PE.compare("00**00****00",E))&&(log(logType.net,"Short names detected! (mask)"),m=!0),!m&&PE.compare("00**00",E))for(var h=0,S="QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm",l=1;l<S.length&&!m;l++)PE.isNetObjectPresent(S[l])&&(log(logType.net,'Short name found: "'+S[l]+'" ('+h+"/20)"),h++),20===h&&(m=!0)
m&&(e=addOption(e,"Short names"))
for(var f=!1,_="",l=0;l<300;l++){var y=PE.readByte(E+l).toString(16)
"0"===y&&(y+="0"),_=_+y+" "}for(var b="",C=replaceAllInString(_,"00 ","20 20 20 ").split(" "),l=0;l<C.length;l++)b+=String.fromCharCode(parseInt(C[l],16))
for(var x=b.split("   "),M=0,X=validateNetObject("<PrivateImplementationDetails>"),l=0;l<x.length&&!f;l++){var v=x[l]
if(X&&40===v.length)break;-1===v.indexOf("<")&&!/^([0-9A-F]{64})$/.test(v)&&isNameObfuscated(v)&&M++,2<M&&(f=!0)}f&&(e=addOption(e,"Bad namings"))
for(var i=!1,p=((validateNetUnicodeString(" is tampered.")||validateNetUnicodeString("ping 127.0.0.1 > nul")||validateNetUnicodeString('/C ping 1.1.1.1 -n 1 -w 3000 > Nul & Del "')||validateNetUnicodeString(P.ldloc_s+P.ldc_i4_0+P.ldloc_s+P.ldc_i4_0+P.ldelem_u4+P.ldloc_s+P.ldc_i4_0+P.ldelem_u4+P._unknown+P.stelem_i4+P.ldloc_s+P.ldc_i4_1+P.ldloc_s+P.ldc_i4_1+P.ldelem_u4+P.ldloc_s+P.ldc_i4_1+P.ldelem_u4+P._unknown+P.stelem_i4+P.ldloc_s+P.ldc_i4_2+P.ldloc_s+P.ldc_i4_2+P.ldelem_u4+P.ldloc_s+P.ldc_i4_2+P.ldelem_u4+P._unknown+P.stelem_i4+P.ldloc_s+P.ldc_i4_3+P.ldloc_s+P.ldc_i4_3+P.ldelem_u4+P.ldloc_s+P.ldc_i4_3+P.ldelem_u4+P._unknown+P.stelem_i4+P.ldloc_s+P.ldc_i4_4+P.ldloc_s+P.ldc_i4_4+P.ldelem_u4+P.ldloc_s+P.ldc_i4_4+P.ldelem_u4+P._unknown+P.stelem_i4)||validateNetByteCode(P.ldloc_s+P._unknown+P.shr_un+P.ldloc_s+P.ldc_i4_s+P.shl+P.or+P.stloc_s+P.ldloc_s+P._unknown+P.shr_un+P.ldloc_s+P.ldc_i4_s+P.shl+P.or+P.stloc_s+P.ldloc_s+P._unknown+P.shr_un+P.ldloc_s+P.ldc_i4_s+P.shl+P.or+P.stloc_s))&&(log(logType.net,"Anti-tamper detected!"),i=!0),i&&(e=addOption(e,"Anti-tamper")),!1),i=PE.findSignature(PE.getDosStubOffset()+PE.getDosStubSize(),PE.getSize()-PE.getOverlaySize(),"00'<Module>'00"),O=(-1!==i&&-1!==(O=PE.findSignature(i+10,PE.getSize()-PE.getOverlaySize(),"'<Module>'"))&&0!==PE.readByte(O+8)&&(log(logType.net,"Fake <Module> detected! Offset: 0x"+Number(O).toString(16)),p=!0),p&&(e=addOption(e,"Fake .cctor name")),!1),N=(-1===i&&(log(logType.net,"It seems that the .cctor is missing. Bad PE format!"),O=!0),O&&(e=addOption(e,"Bad .cctor format")),!1),w=[P.add,P.sub,P.mul,P.div,P.xor,P.shr,P.shl,P.or,P.not,P.and],V=[P.ldc_i4+P.ldc_i4+"%s"+P.stloc,P.ldc_i4+P.ldc_i4+"%s"+P.ldsfld,P.ldc_i4+P.ldc_i4+"%s"+P.ldc_i4+P.add,P.ldloc_1+P.ldc_i4+P.ldc_i4+"%s"+P.ldc_i4+P.ldc_i4,P.ldloc+P.ldc_i4+P.ldc_i4+P.ldc_i4+"%s"+P.stelem_i1,P.ldc_i4+P.ldc_i4+"%s"+P.br_s],A=0;A<V.length&&!N;A++)for(var H=V[A],k=0;k<w.length&&!N&&(0!==k||validateNetByteCode(replaceAllInString(H,"%s",P._unknown)));k++)validateNetByteCode(replaceAllInString(H,"%s",w[k]))&&(log(logType.net,"Math mutations detected! Offset: "+lastOffsetDetected),N=!0)
N&&(e=addOption(e,"Math mutations"))
var p=!1,i=(PE_Cached.isVbNetStandardLibraryPresent&&!isFrameworkComponent()&&validateNetObject("Resources")&&!validateGlobalUnicodeString(".Resources")&&(log(logType.net,"It appears that the strings are hidden/encrypted and can be loaded dynamically."),p=!0),p&&(e=addOption(e,"Strings encryption")),!1),O=(validateNetByteCode(P.ldc_i4+P.not)&&(validateNetByteCode(P.ldc_i4+P.not+P.neg+P.not+P.neg+P.not+P.neg+P.not+P.neg)||validateNetByteCode(P.ldc_i4+P.not+P.not+P.neg+P.neg+P.not+P.not)||validateNetByteCode(P.ldc_i4+P.not+P.neg+P.not+P.not+P.neg+P.neg)||validateNetByteCode(P.ldc_i4+P.not+P.neg+P.not+P.neg+P.not+P.not)||validateNetByteCode(P.ldc_i4+P.not+P.neg+P.not+P.neg+P.not+P.neg))&&(log(logType.net,"Math inversions detected, offset "+lastOffsetDetected),i=!0),i&&(e=addOption(e,"Math inversions")),!1),$=(validateNetByteCode(P.setStrict(P.calli,"FF FF FF FF")+P.setStrict(P.sizeof,"FF FF FF FF"))&&(log(logType.net,"Invalid OpCodes detected, offset "+lastOffsetDetected),O=!0),O&&(e=addOption(e,"Invalid OpCodes")),!1),j=""
const D=[{lib:"haspdnert.dll",name:"SafeNet Sentinel LDK"},{lib:"AgileDotNet.VMRuntime.dll",name:"Agile"},{lib:"Xerin.Runtime.dll",name:"XerinFuscator"},{lib:"CliSecureRd64.dll",name:"CliSecure"},{lib:"CliSecureRd.dll",name:"CliSecure"},{lib:"Protect32.dll",name:"ILProtector"},{lib:"Protect64.dll",name:"ILProtector"},{lib:"OneVM.Runtime.dll",name:"OneVM"},{lib:"MRuntime3.dll",name:"Maxtocode"},{lib:"Attick.dll",name:"Maxtocode"},{lib:"HVMRuntm.dll",name:"DNGuard"}]
for(l=0;l<D.length;l++){var I=D[l],R=I.lib,I=I.name
if(validateNetObject(R)||validateNetObject(R.substring(0,R.length-4))){log(logType.net,I+" runtime detected!"),$=!0,j=I
break}}D=void 0,$&&(e=addOption(e,j+" runtime"))
for(var T=["Xenocode.Client.Attributes.AssemblyAttributes.ProcessedByXenocode","CryptoObfuscator.ProtectedWithCryptoObfuscatorAttribute","SecureTeam.Attributes.ObfuscatedByAgileDotNetAttribute","Xenocode.Client.Attributes.AssemblyAttributes","SmartAssembly.Attributes.PoweredByAttribute","ObfuscatedByAgileDotNetAttribute","NineRays.Obfuscator.Evaluation","ObfuscatedByCliSecureAttribute","BabelObfuscatorAttribute","AsStrongAsFuckAttribute","ProtectedByDotnetsafer","Macrobject.Obfuscator","DotfuscatorAttribute","CodeWallTrialVersion","ConfusedByAttribute","ObfuscatedByGoliath","NETSpider.Attribute","NineRays.Obfuscator","PoweredByAttribute","RustemSoft.Skater","Beds-Protector","BabelAttribute","MRuntime3.dll","YanoAttribute","EMyPID_8234_","ZYXDNGuarder","SkiDzEX","Sixxpack","____KILL","Reactor"],F=!1,p=!1,U=0,G="",B=0;B<T.length;B++)if(validateNetObject(T[B])&&(G=T[B],1<++U)){F=!0
break}F?e=addOption(e,"Fake signatures"):(1===U&&(log(logType.net,'Watermark (Attribute) found: "'+G+'"'),p=!0),p||!(validateSignature("'Obfuscated'")||validateSignature("'obfuscated'")||validateSignature("'ByAttribute'")||validateSignature("'ObfuscatorAttribute'")||validateNetObject("ObfuscationAttribute"))||isFrameworkComponent()||(p=!0)),p&&(e=addOption(e,"Watermark"))
var i=!1,O=PE_Cached.nameOfNetAssemblyName,p=PE_Cached.nameOfNetModuleName,W=((O=0===O.indexOf("Interop.")?O.substring(8,O.length):O)===getFileNameWithoutExtension(p)&&O!==p||(i=!0,PE_Cached.isJscriptNetStandardLibraryPresent&&"JScript Module"===p&&(i=!1)),i&&(e=addOption(e,"Modified build info")),["SafeNet Sentinel LDK .NET","Xenocode Postbuild","Smart Assembly","Dotfuscator","Babel .NET","Spices.Net","Maxtocode","FISH .NET","CliSecure","CodeWall","CodeVeil","Sixxpack","DNGuard","Goliath","Agile","Yano"]),L=["Quest PowerGUI","DataAnubis","NsPack","ASPack"],z=["Sentinel SuperPro dongle reference","Unikey/Activator dongle reference","Eutron SmartKey dongle reference","SenseLock dongle reference","Hardlock dongle reference","WIBU Key dongle reference","Wizzkey dongle reference","SoftLok dongle reference","NetHASP dongle reference"]
if(F){for(l=0;l<W.length;l++)_removeResult("protector",W[l])
for(l=0;l<L.length;l++)_removeResult("cryptor",L[l]),_removeResult("packer",L[l])
for(l=0;l<z.length;l++)_removeResult("protection",z[l])}(t=0!=e.length?!0:t)&&_setResult("~protection","Obfuscation","",PE.isVerbose()?e:"")}function scanForAntiAnalysis_NET(){log(logType.nothing,"Scanning for anti-analysis tricks...")
for(var e="",t=!1,i=!1,n="Debugger",r="get_IsAttached",s="IsLogging",n=((i=((validateNetObject(n)||validateNetUnicodeString(n))&&(validateNetObject(r)||validateNetUnicodeString(r)||validateNetObject(s)||validateNetUnicodeString(s))||validateNetObject("CheckRemoteDebuggerPresent")||validateNetObject("IsDebuggerPresent")||validateNetObject("NtRemoveProcessDebug")||validateNetObject("NtQueryInformationProcess"))&&!isFrameworkComponent()?!0:i)&&(e=addOption(e,"Anti-debug")),!1),o=((n=!isFrameworkComponent()&&validateNetObject("VirtualProtect")&&(isAllNetReferencesPresent(["System.Runtime.InteropServices","Marshal","GetHINSTANCE","IntPtr","op_Explicit"])||isAllNetReferencesPresent(["System.Diagnostics","memcpy","IntPtr","get_MainModule","get_BaseAddress"])||isAllNetReferencesPresent(["System.Runtime.InteropServices","Marshal","GetHINSTANCE","IntPtr","CopyBlock","InitBlock"]))?!0:n)&&(e=addOption(e,"Anti-dump")),["dnspy","dnSpy","DNSPY"]),a=!1,l=0;l<o.length&&!a;l++){var d=o[l];(validateGlobalUnicodeString(d)||validateSignature("'"+d+"'"))&&(a=!0)}a&&(e=addOption(e,"Anti-dnSpy"))
for(var c=["ilspy","ilSpy","ILSpy","ILSPY"],u=!1,l=0;l<c.length&&!u;l++){var g=c[l];(validateGlobalUnicodeString(g)||validateSignature("'"+g+"'"))&&(u=!0)}u&&(e=addOption(e,"Anti-ILSpy"))
var r=validateSignature("'GetModuleHandle'"),P=["sbiedll.","SbieDll.","SBIEDLL."],p=!1
if(r)for(l=0;l<P.length&&!p;l++){var E=P[l];(PE.isNetObjectPresent("IsSandboxiePresent")||validateGlobalUnicodeString(E)||validateSignature("'"+E+"'"))&&(p=!0)}p&&(e=addOption(e,"Anti-SandBoxie"))
var m=["cmdvrt32.","cmdvrt64.","CMDVRT32.","CMDVRT64."],h=!1
if(r)for(l=0;l<m.length&&!h;l++){var S=m[l];(PE.isNetObjectPresent("IsComodoSandboxPresent")||validateGlobalUnicodeString(S)||validateSignature("'"+S+"'"))&&(h=!0)}h&&(e=addOption(e,"Anti-Comodo"))
var f=["SxIn.","SXIn."],_=!1
if(r)for(l=0;l<f.length&&!_;l++){var y=f[l];(PE.isNetObjectPresent("IsQihoo360SandboxPresent")||validateGlobalUnicodeString(y)||validateSignature("'"+y+"'"))&&(_=!0)}_&&(e=addOption(e,"Anti-Qihoo 360"))
var b=["cuckoomon.","CUCKOOMON."],C=!1
if(r)for(l=0;l<b.length&&!C;l++){var v=b[l];(PE.isNetObjectPresent("IsCuckooSandboxPresent")||validateGlobalUnicodeString(v)||validateSignature("'"+v+"'"))&&(C=!0)}C&&(e=addOption(e,"Anti-Cuckoo"))
s=!1,i="wine_get_unix_file_name",(s=r&&(validateGlobalUnicodeString(i)||validateSignature("'"+i+"'"))?!0:s)&&(e=addOption(e,"Anti-Wine")),n=!1;(t=0!=(e=(n=validateNetUnicodeString("vmware")||validateNetUnicodeString("VirtualBox")||validateNetUnicodeString("VMBusHID")||validateGlobalUnicodeString("WDAGUtilityAccount")?!0:n)?addOption(e,"Anti-VM"):e).length?!0:t)&&_setResult("~protection","Anti analysis","",PE.isVerbose()?e:"")}function isCppClrLikeApp(){return PE_Cached.isDotNet&&PE_Cached.isRichSignaturePresent&&PE.isLibraryPresent("KERNEL32.DLL")&&PE_Cached.isNetGlobalCctorPresent}function isUnpackagedWindowsAppSdkLinked(){return PE.isNetObjectPresent("AutoInitialize")&&PE.isNetObjectPresent("InitializeWindowsAppSDK")}function NetOpCodes(){this.dup="25",this.nop="00",this.pop="26",this.add="58",this.add_ovf="D6",this.add_ovf_un="D7",this.div="5B",this.div_un="5C",this.mul="5A",this.mul_ovf="D8",this.mul_ovf_un="D9",this.neg="65",this.rem="5D",this.rem_un="5E",this.sub="59",this.sub_ovf="DA",this.sub_ovf_un="DB",this.and="5F",this.not="66",this.or="60",this.shl="62",this.shr="63",this.shr_un="64",this.xor="61",this.ceq="FE01",this.cgt="FE02",this.cgt_un="FE03",this.clt="FE04",this.clt_un="FE05",this.ldc_i4_m1="15",this.ldc_i4="20????????",this.ldc_i4_0="16",this.ldc_i4_1="17",this.ldc_i4_2="18",this.ldc_i4_3="19",this.ldc_i4_4="1A",this.ldc_i4_5="1B",this.ldc_i4_6="1C",this.ldc_i4_7="1D",this.ldc_i4_8="1E",this.ldc_i4_s="1F??",this.ldc_i8="21????????????????",this.ldc_r4="22????????",this.ldc_r8="23????????????????",this.ldnull="14",this.ldarg="FE09????",this.ldarg_0="02",this.ldarg_1="03",this.ldarg_2="04",this.ldarg_3="05",this.ldarg_s="0E??",this.starg_s="10??",this.ldarga="FE0A????",this.ldarga_s="0F??",this.starg="FE0B????",this.ldloca="FE09????",this.ldloca_s="12??",this.ldloc="FE0C????",this.ldloc_0="06",this.ldloc_1="07",this.ldloc_2="08",this.ldloc_3="09",this.ldloc_s="11??",this.stloc="FE0E????",this.stloc_0="0A",this.stloc_1="0B",this.stloc_2="0C",this.stloc_3="0D",this.stloc_s="13??",this.ldfld="7B????????",this.ldflda="7C????????",this.ldsfld="7E????????",this.ldsflda="7F????????",this.stfld="7D????????",this.stsfld="80????????",this.ldelem="A3????????",this.ldelem_i="97",this.ldelem_i1="90",this.ldelem_i2="92",this.ldelem_i4="94",this.ldelem_i8="96",this.ldelem_r4="98",this.ldelem_r8="99",this.ldelem_ref="9A",this.ldelem_u1="91",this.ldelem_u2="93",this.ldelem_u4="95",this.ldelema="8F????????",this.ldlen="8E",this.newarr="8D????????",this.stelem="A4????????",this.stelem_i="9B",this.stelem_i1="9C",this.stelem_i2="9D",this.stelem_i4="9E",this.stelem_i8="9F",this.stelem_r4="A0",this.stelem_r8="A1",this.stelem_ref="A2",this.ldind_i="4D",this.ldind_i1="46",this.ldind_i2="48",this.ldind_i4="4A",this.ldind_i8="4C",this.ldind_r4="4E",this.ldind_r8="4F",this.ldind_ref="50",this.ldind_u1="47",this.ldind_u2="49",this.ldind_u4="4B",this.stind_i="DF",this.stind_i1="52",this.stind_i2="53",this.stind_i4="54",this.stind_i8="55",this.stind_r4="56",this.stind_r8="57",this.stind_ref="51",this.beq="3B????????",this.beq_s="2E??",this.bge="3C????????",this.bge_s="2F??",this.bge_un="41????????",this.bge_un_s="34??",this.bgt="3D????????",this.bgt_s="30??",this.bgt_un="42????????",this.bgt_un_s="35??",this.ble="3E????????",this.ble_s="31??",this.ble_un="43????????",this.ble_un_s="36??",this.blt="3F????????",this.blt_s="32??",this.blt_un="44????????",this.blt_un_s="37??",this.bne_un="40????????",this.bne_un_s="33??",this.br="38????????",this.br_s="2B??",this.break_="01",this.brfalse="39????????",this.brfalse_s="2C??",this.brtrue="3A????????",this.brtrue_s="2D??",this.call="28????????",this.calli="29????????",this.callvirt="6F????????",this.jmp="27????????",this.ldtoken="D0????????",this.ldftn="FE06????????",this.ldvirtftn="FE07????????",this.leave="DD????????",this.leave_s="DE??",this.ret="2A",this.switch__nobody="45",this.box="8C????????",this.castclass="74????????",this.ckfinite="C3",this.conv_i="D3",this.conv_i1="67",this.conv_i2="68",this.conv_i4="69",this.conv_i8="6A",this.conv_ovf_i="D4",this.conv_ovf_i_un="8A",this.conv_ovf_i1="B3",this.conv_ovf_i1_un="82",this.conv_ovf_i2="B5",this.conv_ovf_i2_un="83",this.conv_ovf_i4="B7",this.conv_ovf_i4_un="84",this.conv_ovf_i8="B9",this.conv_ovf_i8_un="85",this.conv_ovf_u="D5",this.conv_ovf_u_un="8B",this.conv_ovf_u1="B4",this.conv_ovf_u1_un="86",this.conv_ovf_u2="B6",this.conv_ovf_u2_un="87",this.conv_ovf_u4="B8",this.conv_ovf_u4_un="88",this.conv_ovf_u8="BA",this.conv_ovf_u8_un="89",this.conv_r_un="76",this.conv_r4="6B",this.conv_r8="6C",this.conv_u="E0",this.conv_u1="D2",this.conv_u2="D1",this.conv_u4="6D",this.conv_u8="6E",this.isinst="75????????",this.mkrefany="C6????????",this.refanytype="FE1D",this.refanyval="C2????????",this.sizeof="FE1C????????",this.unbox="79????????",this.unbox_any="A5????????",this.cpblk="FE17",this.cpobj="70????????",this.initblk="FE18",this.initobj="FE15????????",this.ldobj="71????????",this.ldstr="72????????",this.localloc="FE0F",this.newobj="73????????",this.stobj="81????????",this.endfilter="FE11",this.endfinally="DC",this.rethrow="FE1A",this._throw="7A",this.constrained="FE16????????",this.no_="FE19??",this.readonly="FE1E",this.unaligned="FE12??",this.volatile="FE13",this._unknown="**",this._any="??",this.arglist="FE00",this.setStrict=function(e,t){e=removeWhitespaces(e),t=removeWhitespaces(t)
var i=e.indexOf("??"),n=-1!==i,i=n?e.substring(0,i):e
return n&&e.substring(i.length).length!=t.length&&_error("The size of the input values does not match."),i+t},this.setNullValue=function(e){return-1===e.indexOf("??")&&_error("Instruction does not have a body to overwrite the value."),replaceAllInString(e,"??","00")},this.joinNoBodyAndValue=function(e,t,i){return e&&"string"==typeof e||_error("Invalid opcode provided."),t&&"string"==typeof t||_error("Invalid value provided."),-1!==e.indexOf("??")&&_error("Opcode contains wildcards. Use setStrict() instead."),i&&"string"==typeof i&&-1===i.indexOf("__nobody")&&_error("joinNoBodyAndValue should only be used with '__nobody' opcodes (variable-length instructions)."),e+removeWhitespaces(t)}}function removeWhitespaces(e){return e&&"string"==typeof e?e.replace(/\s+/g,""):""}function replaceAllInString(e,t,i){return e&&"string"==typeof e?t&&"string"==typeof t?("string"!=typeof i&&(i=""),e.split(t).join(i)):e:""}function clearSectionName(e){return e&&"string"==typeof e?e.replace(/[\x00-\x1F\x7F-\x9F]/g,"").trim():""}function isAsciiString(e){return!(!e||"string"!=typeof e)&&/^[\x20-\x7E]+$/.test(e)}function getFileNameWithoutExtension(e){var t
return e&&"string"==typeof e?-1===(t=e.lastIndexOf("."))?e:e.substring(0,t):""}function scanForPackersAndCryptors_NET_and_Native(){log(logType.nothing,"Scanning for packers and cryptors...")
var e="",x=!1,t=!1
if(PE_Cached.isDotNet){var i=!1
if(!isFrameworkComponent()&&"System.dll"!==PE_Cached.nameOfNetModuleName&&isAllNetReferencesPresent(["System.Reflection","get_EntryPoint","Assembly","Invoke","Load"])&&(i=!0,e="Assembly invoke"),findAndMark("System.Security.Cryptography",!1)!="")for(var n,M=["TripleDESCryptoServiceProvider","RSACryptoServiceProvider","DSACryptoServiceProvider","DESCryptoServiceProvider","AesCryptoServiceProvider","Rfc2898DeriveBytes","TripleDES","Rijndael","ECDsaCng","AesAEAD","Aes192Cbc","Aes256Cbc","Aes128Cbc","AesManaged","AesCng","RC2CryptoServiceProvider","RNGCryptoServiceProvider"],r=0;r<M.length;r++)t||(o=findAndMark(n=M[r],!0),i&&o.length&&(log(logType.net,"Crypto class present: "+n),t=!0,e=addOption(e,n)))
if(findAndMark("System.IO.Compression",!1).length)for(var X=["DeflateStream","GZipStream"],r=0;r<X.length;r++){var s=X[r],o=findAndMark(s,!0)
if(i&&o.length){log(logType.net,"Compression class present: "+s),t&&(e=addOption(e,s))
break}}var a=!1;(validateNetObject("RunPE")||validateNetObject("PELoader")||validateNetObject("CMemoryExecute")||validateNetObject("GetProcAddress")&&validateNetUnicodeString("WriteProcessMemory")&&validateNetUnicodeString("VirtualAllocEx")&&validateNetUnicodeString("ZwUnmapViewOfSection")||(validateNetObject("WriteProcessMemory")||validateNetObject("NtWriteVirtualMemory"))&&(validateNetObject("ZwUnmapViewOfSection")||validateNetObject("NtUnmapViewOfSection"))&&(validateNetObject("CreateProcess")||validateNetObject("NtCreateProcess")||validateNetObject("CreateProcessA")||validateNetObject("CreateProcessW"))&&validateNetObject("VirtualAllocEx"))&&(log(logType.net,"RunPE-like behavior detected!"),a=!0),a&&(e=addOption(e,"RunPE"))}var l=!1
if(!PE_Cached.isDynamicLinkLibrary&&PE.isOverlayPresent()){for(var d=["'Rar!'","'PK'03","';!@Install@!UTF-8!'","'7z'BCAF271C","efbbbf';!@Install@!UTF-8!'"],c=0;c<d.length;c++)PE.compareOverlay(d[c])&&(log(logType.nothing,"SFX overlay pattern: "+d[c]),l=!0)
if(!l&&!PE_Cached.isDotNet){var u=["83EC..5657FF15........8BF08D4424..50C74424..........FF15........8A068B3D........3C..75..56FFD7","E9$$$$$$$$558BEC81EC........830D..........5356576A..33DBBF........68........895D..881D","558BEC83EC..56FF15........8BF08A003C..75..84C074..803E..74..46803E..75..803E..75..46EB","6A..33C0505050FF15........50E8$$$$$$$$55B8........8BECE8........53B9........5657BE","6A..68........E8........66813D............75..A1........81B8................75..","558BEC83EC..565733FFFF15........8BF0897D..8D45..50FF15........8A063C..75..56FF15","51526A..2EFF15........506A..6A..2EFF15........50E8........502EFF15........5A59C3","558BEC81EC........535657FF15........A3........FF15........A1........6625....3D","558BECB8........E8........5356BE........578D45..5633DB5053FF15........85C00F84","A1........C1E0..A3........575133C0BF........B9........3BCF76..2BCFFCF3AA595F","558BEC83C4..5356E8$$$$$$$$E8........6A..E8........8905........E8........8905","FF15........B1..380874..B1..4080....74..380874..4080....75..80....74..4033","53FF15........B3..38..74..80C3..4033D28A083ACA74..3ACB74..408A083ACA75","558BEC83C4..535657E8........E8........33C05568........64FF30648920E8","53FF15........B3..38..74..80C3..8A48..4033D23ACA74..3ACB74..8A48..40","E8$$$$$$$$53BB........E8........85C074..33D28A1083FA..75..40EB","FFFE2A002A002A006D0065007300730061006700650073002A002A002A00","E8$$$$$$$$558BEC83C4..B8........53","8A48014033D23ACA740A3ACB74068A4801"]
PE.isSectionNamePresent("_winzip_")&&(l=!0)
for(var g=0;g<u.length;g++)PE.compareEP(u[g])&&(log(logType.nothing,'EP like SFX: "'+u[g]+'"'),l=!0)}}l&&(e=addOption(e,"SFX"))
for(var w,P=!1,V=["53565755488D35........488DBE","B8........68........64","60..................E8","33C08BC068........68","74..E9........60E8","EB0668........C39C","93071F05....8ED0BC","60BE........8DBE","B8........6A..68","BE........AD8BF8","68........9C60E8","53558BE833DBEB60","E8000000005D81ED","BD........C745","57565351524150","B8........5064","8CCBBA....03DA","B8........669C","E8........53","8CC0FA8ED0BC","B8........60","8B44240456","1E068CC88E","1E068CCBBA","EB..9C60E8","9C60E8CA","60FCBED4","60EB..5D","60EB..E8","64FF35","6033C0","669C60","EB..60","60E8","6068","9C60"],H=0;H<V.length&&!P;H++)P||(w=V[H],PE.compareEP(w)&&(log(logType.nothing,'EP like a packer: "'+w+'"'),P=!0))
P&&(e=addOption(e,"EntryPoint"))
var p,$=!1
if(PE_Cached.isArchX86)switch(p=getFirstEpAsmOpCode()){case"PUSHAL":case"PUSHA":case"PUSHF":case"POPA":log(logType.nothing,'"'+p+'" at EP'),$=!0}else switch(p=getFirstEpAsmOpCode()){case"POP":case"STMDB":case"LDMIA":case"STMFD":case"LDMFD":log(logType.nothing,'"'+p+'" at EP'),$=!0}$&&(e=addOption(e,p[0].toUpperCase()+p.toLowerCase().substring(1,p.length)+" at EP"))
a=!1
if(!PE_Cached.isDynamicLinkLibrary&&1<PE_Cached.numberOfSections){for(var E=-1,m=-1,r=1;-1==E;r++)E=PE.OffsetToVA(PE.getSectionFileOffset(PE_Cached.numberOfSections-r))
E<=(m=PE.getAddressOfEntryPoint())&&(log(logType.nothing,"EP address (0x"+m.toString(16)+") more than last section address (0x"+E.toString(16)+")"),a=!0)}a&&(e=addOption(e,"Last section EP"))
for(var m=!1,a=(PE_Cached.isArchX86?(h=getAsmOpCode(PE_Cached.firstEpAsmInstruction),PE_Cached.isDynamicLinkLibrary||!a||PE.compareEP("E8 00 00 00 00")||"CALL"!==h&&"JMP"!==h||(log(logType.nothing,"Strange "+h.toLowerCase()+" at EP to address: "+PE_Cached.firstEpAsmInstruction.split(" ")[1].toLowerCase()),m=!0)):(h=getAsmOpCode(PE_Cached.firstEpAsmInstruction),PE_Cached.isDynamicLinkLibrary||!a||"B"!==h&&"BL"!==h&&"BX"!==h&&"BLX"!==h||(log(logType.nothing,"Strange "+h.toLowerCase()+" at EP to address: "+PE_Cached.firstEpAsmInstruction.split(" ")[1].toLowerCase()),m=!0)),m&&(e=addOption(e,"Strange "+h.toLowerCase()+" at EP")),!1),m=validateImportHashes([["UPX","0.59-0.93",0,3573402289,0],["UPX","0.94-1.93",0,491858330,0],["UPX","1.94-2.03",0,[3006365830,930654905],0],["UPX","2.90-3.XX",0,4084592131,0],["UPX","2.90-3.XX",-1,4147632211,0],["UPX","3.91+",-1,[2191542524,1430918984],0],["PESpin",null,2,3573402289,0],["NsPack",null,0,4084592131,0],["NsPack","3.X",0,2249268809,0],["ASPack","1.XX-2.XX",0,309523547,0],["ASPack",null,0,4000227700,0],["MKFPACK",null,0,1119086585,0],["MPRESS",null,0,391052164,0],["Packman","0.0.0.1",0,391052164,0],["Packman","1.0",0,1762093699,0],["PECompact","0.90-0.91",-1,3198424785,0],["PECompact","0.92-0.94",-1,2469473326,0],["PECompact","0.97-0.971b",-1,3869934741,0],["PECompact","1.10b7-1.34",-1,3837858565,0],["PECompact","1.30-1.40",0,2603812333,0],["PECompact","1.40-1.84",0,3428526652,0],["PECompact","2.40-3.XX",0,642960975,0],["PECompact","2.40-3.XX",-1,3683629941,0],["tElock","1.0",-1,85542647,0],["tElock","0.98",0,911341197,0],["JDPACK","2.00",0,3221412622,0],["CRINKLER",null,0,185475007,0],["XComp","0.97-0.98",-1,3927860964,0],["XPack",null,-1,[717508050,1813449395],0],["kkrunchy",null,0,689473049,0],["ANDPakk2","0.18",-1,689473049,0],["RLPack","1.1-1.2",0,1540478739,0],["RLPack","1.16+",0,1753837915,0],["Petite","2.2",-1,1642411650,0],["bambam","0.1-0.4",0,3048297421,0],["py2exe",null,2,3851452410,0],["py2exe",null,-1,3309619794,0],["MEW",null,0,2267106898,0],["nPack","1.1+",0,3129734334,0],["CExe","1.0a",0,3707200722,0],["PE-PACK","1.0",0,2765710967,0],["BoxedApp",null,0,1644609730,0],["VPacker","0.02.X",0,3955473552,0],["PKLITE32","1.1",0,[1646205435,3993289522],0],["PKLITE32","1.1",1,407189991,0],["PeX","0.99",0,1606377432,0],["XComp",null,0,1271213687,0],["Fatpack",null,0,1948535057,0],["Yoda's Crypter","1.X",-1,319005979,1],["EXECryptor","1.4-1.5",-1,3521008565,1],["EXECryptor","2.X",-1,4112197655,1],["Amber",null,-1,2546409553,1],["Lumy",null,-1,2182506965,1],["ASProtect","1.XX-2.XX",0,309523547,2],["Shrinker","3.2",0,[2997241944,361427664,1239984671],2],["Shrinker","3.5",0,[3924428881,860141917,1482721523],2],["Enigma","1.00-3.60",0,3221412622,2],["Enigma","2.XX",0,3717389840,2],["Enigma","3.70+",0,3494672976,2],["PCGUARD","5.04-5.05",0,[1511431290,185280869],2],["Vbs To Exe",null,1,[734392825,10102889,1518135254,3843270269,1298528546],2],["eXPressor","1.2",-1,[1723030638,854869612],2],["eXPressor","1.3",-1,[2451374720,4112431720,3162820105],2],["eXPressor","1.4.5.X",0,[1115166379,1013996718,1292034195,2508889762],2],["eXPressor","1.5.0.X",-1,[2059058010,2513049060,3175209504],2],["eXPressor","1.6",-1,3394828812,2],["eXPressor","1.6",0,817627193,2],["eXPressor","1.6.1",0,2776181286,2],["eXPressor","1.6.1",-1,1224725337,2],["VMProtect","1.70",-1,536023103,2],["VMProtect","2.0.3-2.13",-1,2635247955,2],["VMProtect","3.0.0",-1,508887233,2],["VMProtect","3.0.9",-1,3321588299,2],["VMProtect","3.2.0-3.5.0",-1,1554684359,2],["VMProtect","3.6.0+",-1,[1725970772,3672765808],2],["YodasProtector","1.0b",-1,319005979,2],["ASM Guard","2.XX+",-1,4058043963,2],["Themida","2.XX-3.XX",0,1073532042,2],["Themida",null,0,2912404739,2],[".NET Reactor",null,0,2529070630,2],[".NET Reactor",null,1,3033375535,2],["Bat To Exe Converter",null,0,1923271268,2],["Vbs To Exe Converter",null,0,405449832,2],["DNGuard",null,0,943924593,2],["DNGuard","4.9+",0,2583213454,2],["obfus.h",null,-1,49575711,2],["Crunch","1.0-2.0",0,1633052125,2],["Private EXE Protector",null,0,3634034317,2],["CodeVirtualizer",null,4,1337911843,2],["PELock",null,0,[1857615601,3849451285],2],["PELock","2.X",0,3781729660,2],["CrypToCrack","0.9.X",0,2334702414,2],["DBPE",null,0,[807065429,859859683],2],["Virbox",null,0,3874160781,2],["Quick Batch File Compiler",null,-1,879780090,2],["CodeVeil",null,0,3536358044,2]]),h=(null!=m&&(S=m[1],log(logType.nothing,"Imports hash like "+m[0]+(S?" (version "+S+")":"")),a=!0),a&&(e=addOption(e,"Imports like "+m[0]+(S?" (v"+m[1]+")":""))),!1),S=validateSectionNames([["DBPE",null,"        "],["Themida","2.XX","   "],["Themida","3.XX",[".imports",".loadcon",".themida",".winlice"]],["Themida",null,[".stub01","WinLicen",".v-lizer","Themida "]],["PEBundle",null,/^(PEB|peb)undle$/],["DZA Patcher",null,"yoda"],["UPX",null,/^UPX[0-3]$/],["VMProtect",null,/^\.vmp[0-3]$/],[".NET Reactor","2.XX",".reacto"],["ACProtect",null,".perplex"],["ANDpakk2",null,"ANDpakk2"],["ASM Guard","2.XX",[".asmg","ASMGUARD"]],["ASPack","1.08-2.XX",".adata"],["ASPack","2.XX",".aspack"],["ASPack",null,/^(\.)?ASPack$/],["Alienyze",null,".alien"],["BoxedApp",null,".bxpck"],["CodeVirtualizer",null,".vlizer"],["Enigma",null,/^\.enigma[12]$/],["Eronana",null,".packer"],["MPRESS",null,/^\.MPRESS[12]$/],["NsPack",null,[/^(\.)?nsp[01]$/,/^PE[Pp][01]$/,".Packer!"]],["PE Diminisher",null,".teraphy"],["PE-SHiELD",null,"PESHiELD"],["PECompact",null,[/^PEC2(MO)?$/,/^pec(1)?$/]],["PELock",null,["PELOCKnt",".pelock"]],["Petite",null,/^(\.)?petite$/],["SecuROM",null,[/^\.cms_[dt]$/,".securom",".dsstext"]],["StarForce","3.X",[".sforce3",".brick"]],["Wise Installer",null,".wise"],["Gentee Installer",null,".gentee"],["Nullsoft Installer",null,".ndata"],["WiX Installer",null,".wixburn"],["BeRoEXEPacker",null,["packerBY","bero^fr "]],["Warbird",null,"?g_Encry"],["YodasCrypter","1.X","yC"],["eXPressor",null,/^\.ex_(cod|rsc)$/],["kkrunchy",null,"kkrunchy"],["tElock",null,"UPX!"],["Private EXE Protector",null,[".-PEP-",".TRIAL!",".const"]],["AtomPePacker",null,".ATOM"],["ExeStealth",null,"ExeS"],["RLPack",null,[".RLPack",".packed"]],["RLPack",null,"Obsidium"],["BattlEye",null,/^\.be[0-2]$/],["YodasProtector","1.0b",[".y0da",".yP"]],["obfus.h",null,".obfh"],["Windows PE Packer by Chenzs108",null,".shell"],["SoftSentry",null,[/^_(stext|rdata|data|idata|rsrc|reloc)$/,".prdata"]],["PE Lock Phantasm","1.X","DINGBOY"],["XComp",null,/^\.XComp(0)?$/],["XVolkolak",null,".xvlk"],["NetShield",null,"!Sugar"],["Fatpack",null,".fpack  "],["Safengine Shielden",null,".sedat"],["Inquartos Obfuscator",null,".inq"],["WinUPack",null,[".ByDwing",".Upack"]],["Xenocode Postbuild",null,".xcpad"],["Alloy",null,".alloy32"],["Crinkler",null,"lz32.dll"],["Crunch","2.0","BitArts"],["CrypToCrack",null,".ccp3p"],["DxPack","1.0",["coderpub",".reloc1"]],["EXE Pack",null,"!EPack"],["FishPE Shield",null,".FishPE"],["FishPE",null,".FISHEP"],["G!X Protector",null,".g!x"],["JDPack",null,".jdpack"],["Krypton",null,["krypton","YADO","_!_!_!_"]],["MEW",null,"MEW"],["MaskPE",null,".MaskPE"],["Morphnah","1.0.X",".nah"],["NakedPacker",null,/^\.naked[12]$/],["NativeCryptor",null,/^(NATIVES|CONFIG|(F)?CRYPT)~$/],["NeoLite",null,".neolite"],["PE-PACK","1.0","PEPACK!!"],["Perplex",null,".perplex"],["RLP",null,".rlp"],["ORiEN","2.XX",".loader"],["SC Pack",null,".scpack"],["SVK Protector",null,["SVKP",/\.svkp( )?/]],["SafeNet",null,/^\.AKS[1-3]$/],["Shrinker",null,".shrink1"],["Simple Pack",null,".spack"],["Software Compress",null,"SoftComp"],["StarForce","4.X-5.X",".ps4"],["VCL",null,".vcl"],["VirtualizeProtect",null,"VProtect"],["WWPack",null,".WWPACK"],["WWPack32",null,".WWP32"],["dePack","1.3.5",".depack"],["hmimys","1.3","hmimys"],["nPack",null,".nPack"],["yzPack",null,".yzpack2"],["NeoLite",null,".neolit"],["bambam",null,".bedrock"],["WibuKey",null,".wibu"],["Wibu CodeMeter",null,/^__wibu0[01]$/],["AverCryptor","1.0-1.02",[".avc",".Polyene"]],["Huan",null,".huan"],["Morphnah","1.0.X",".nah"],["TSULoader",null,".tsustub"],["RPCrypt",null,/^\.R(Cryptor|PCrypt)$/],["ExE Pack",null,["!EPack",".!ep"]],["XerinFuscator",null,".Xerin"],["AZProtect 0001",null,"AZPR0001"],["ExeShield",null,".shield"],["XPack",null,/^\.XPack(0)?$/],["KByS",null,".shoooo"],["HyperTech Crackproof",null,"peC"],["Byfron",null,/^\.byfron(1)?$/],["DYAMAR","1.3.X",/^\.dyamar[CD]$/],["Alcatraz",null,".0Dev"],["Squishy",null,"logicoma"],["DragonArmor","0.0.4.1",/^(\.)?DAStub$/],["EXECrypt","1.0","CRPT"],["N-Code","0.2",[".pepsi","n-coded",".vrs"]],["NoodleCrypt","2.X",[".Ncryo  ",".De-vir "]],["TheArk",null,["30cm",".tw"]],["Virbox",null,/^\.v(data[1-9]|irbox[1-9]?)$/],["ElecKey",null,".sstb"],["PKLITE32","1.1",".pklstb"],[".BJFnt","1.X",".BJFnt"],["Goliath",null,".GOLIATH"],["PE Encrypt",null,[".ice",".lea"]],["PECRYPT32",null,".ficken"],["PolyCrypt","2.8",/^sec[0-9]$/],["RCryptor",null,/^(\.)?RCryptor$/],["SDProtector",null,".data "],["Shielden",null,".sedata"],["SimbiOZ",null,".ximera"],["LARP","2.X","SnD "],["DalKrypt","1.X",".DalKiT"],["Fish PE","1.2-1.4",".PEDATA"],["NoobyProtect (Safengine)",null,"SE"],["KeySec",null,".ksec"],["Lumy",null,".lumy"],["TomatoX",null,".tomato"],["PwdProtect",null,".pwdprot"],["ID Application",null,/^\.Prt(1)?$/],["PETetris",null,"PETETRIS"]].concat([["Enigma",/^(\.)?enigma$/i],["UPX",[/^\.upx/i,/^upx/]],["VMProtect",/^(\.)?vmp$/i],["MPRESS",/^mpress/i],["Denuvo",/denuvo/i],["Themida",".Themida"]].map(function(e){return["fake "+e[0],null,e[1]]})).concat([["a packer",null,[/p(a)?ck|sh(e)?ll|exe|^\.pe/i,/^PE/]],["a cryptor",null,[/crypt|crpt|stub|enc|inj/i,/stb/]],["a protector",null,[/(?!^prot$)prot|safe|lock|sec|virt|obf|guard|sh(ie)?ld/i,/DRM|drm/]]])),f="",f=(null!=S&&(f=S[1],log(logType.nothing,"Sections like "+S[0]+(f?" (v"+f+")":"")),h=!0),h&&(e=addOption(e,"Sections like "+S[0]+(f?" (v"+S[1]+")":""))),!1),_=validateResourceNames([["Bat To Exe Converter",null,/^(?=[0-9A-F]{40}$)(?=.*[0-9])(?=.*[A-F])[0-9A-F]{40}$/],["Fatpack",null,"FPACK"],["Quick Batch File Compiler",null,"PLATFORMTARGETS"],["ScriptCryptor",null,"AOPT"],["ExeStealth",null,"TN"],[".NET Reactor",null,"__"],["SoftEntry",null,"SENTRYABORTDLG"],["ASM Guard",null,"ASMG.DLL"],["UPX Protector",null,"SCAREBYTE"],["Vbs To Exe",null,"B"],["QQProtect",null,"QQPROTECT"]]),y="",f=(null!=_&&(y=_[1],log(logType.nothing,"Resources like "+_[0]+(y?" (v"+y+")":"")),f=!0),f&&(e=addOption(e,"Resources like "+_[0]+(y?" (v"+y+")":""))),!1),_=PE.getSectionNameCollision("0","1"),j=(_.length&&(log(logType.nothing,'Section names collision: "'+clearSectionName(_)+'"'),f=!0),f&&(e=addOption(e,'Sections collision ("'+clearSectionName(_)+'")')),!1),b={},r=0;r<PE_Cached.numberOfSections&&!j;r++){var C=PE.getSectionName(r)
b[C]=(b[C]||0)+1,1<b[C]&&(log(logType.nothing,'Section names repeating: "'+clearSectionName(C)+'"'),j=!0)}b=void 0,j&&(e=addOption(e,"Section names repeating"))
for(var U=!1,v=-1,O=0;O<PE_Cached.numberOfSections&&!U;O++)v=O,7.4<PE.calculateEntropy(PE.getSectionFileOffset(v),PE.getSectionFileSize(v))&&(log(logType.any,"Section #"+v+' ("'+clearSectionName(PE.getSectionName(v))+'") entropy: '+PE.calculateEntropy(PE.getSectionFileOffset(v),PE.getSectionFileSize(v))),U=!0)
U&&(e=addOption(e,"Section #"+v+' ("'+clearSectionName(PE.getSectionName(v))+'") compressed'))
for(var G=[".bss","BSS",".tls","hydrated"],W=!1,N=-1,A=!1,k=!1,O=0;O<PE_Cached.numberOfSections&&!W;O++){var D,N=O;-1===G.indexOf(PE.getSectionName(N))&&((0===(D=PE.section[N]).FileOffset||D.FileOffset>PE.getSize()-PE.getOverlaySize())&&(A=!0),(0===D.FileSize||D.FileSize>PE.getSize()-PE.getOverlaySize())&&(k=!0),W=A||k)&&log(logType.any,"Section #"+N+' ("'+clearSectionName(PE.getSectionName(N))+'") has wrong '+(A?"offset (0x"+D.FileOffset.toString(16)+")":"")+(A&&k?", ":"")+(k?"size (0x"+D.FileSize.toString(16)+")":""))}W&&(e=addOption(e,"Section #"+N+' ("'+clearSectionName(PE.getSectionName(N))+'") has wrong '+(A?"offset":"")+(A&&k?" and ":"")+(k?"size":"")))
for(var z=!1,K=0,Z="",q=0,Y="",I={},r=0;r<PE_Cached.numberOfSections&&!z;r++){var R,T=r;-1===G.indexOf(PE.getSectionName(T))&&0!==(R=PE.section[T].FileOffset)&&(void 0===I[R]?I[R]=[T]:(log(logType.any,"Section #"+I[R][0]+' ("'+clearSectionName(PE.getSectionName(I[R][0]))+'") and #'+T+' ("'+clearSectionName(PE.getSectionName(T))+'") have one offset: 0x'+R.toString(16)),K=I[R][0],q=T,Z=clearSectionName(PE.getSectionName(K)),Y=clearSectionName(PE.getSectionName(q)),z=!0))}I=void 0,z&&(e=addOption(e,"Section #"+K+' ("'+Z+'") and #'+q+' ("'+Y+'") have one offset'))
for(var y=!1,f=(PE.isOverlayPresent()&&100<=PE.getOverlaySize()&&PE.compareOverlay("'MZ'")&&(log(logType.any,"PE signature at overlay detected"),y=!0),y&&(e=addOption(e,"PE at overlay")),!1),J=(!(y||l||PE.isSigned())&&PE.isOverlayPresent()&&(_=PE.calculateEntropy(PE.getOverlayOffset(),PE.getOverlaySize()),150<PE.getOverlaySize()&&7<_||PE.getOverlaySize()>PE.getSize()-PE.getOverlaySize())&&(log(logType.any,"Overlay size: "+PE.getOverlaySize()+" bytes; Entropy: "+_),f=!0),f&&(e=addOption(e,"Strange overlay")),!1),r=0;r<PE_Cached.numberOfUnmanagedResources&&!J;r++){var Q=PE.getResourceOffsetByNumber(r)
PE.compare("'MZ'",Q)&&(log(logType.any,"PE signature in resources detected"),J=!0)}J&&(e=addOption(e,"PE in resources"))
var y=!1,ee=((y=(!PE_Cached.isDynamicLinkLibrary||!PE.section[".rdata"]&&!PE.isSectionNamePresent(".rsrc"))&&7.3<PE.calculateEntropy(0,PE.getSize()-PE.getOverlaySize())?!0:y)&&(e=addOption(e,"High entropy")),!1),F={}
if(!_isResultPresent("linker","Turbo Linker"))for(r=0;r<PE_Cached.numberOfUnmanagedImports&&!ee;r++){var B=PE.getImportLibraryName(r)
F[B]=(F[B]||0)+1,3<=F[B]&&(log(logType.nothing,'Recurring import name: "'+B+'"'),ee=!0)}if(F=void 0,ee&&(e=addOption(e,"Recurring import names")),a&&!_getNumberOfResults("packer")&&!_getNumberOfResults("cryptor")&&!_getNumberOfResults("protector")&&!_getNumberOfResults("protection")){var L=""
switch(m[4]){case 0:L="packer"
break
case 1:L="cryptor"
break
case 2:L="protector"
break
case 3:L="protection"}L&&(_="",f=!1,m[1]?_=m[1]:h&&!/^(a [pc]|fake )$/.test(S[0])&&(m[0]===S[0]?S[1]&&(_=S[1]):f=!0),_setResult("~"+L,m[0]+(f?"-like":""),_,"Suspicion only"))}(x=0!=e.length?!0:x)&&_setResult("~"+(t?"cryptor":"packer"),"Generic","",PE.isVerbose()?e:"")}function scanForLicensingSystems_NET_and_Native(){log(logType.nothing,"Scanning for licensing systems...")
for(var e="",t=!1,i=(PE_Cached.isDotNet&&(o=!1,(o=validateNetObject("CheckLicense")||validateNetObject("set_License")||validateNetObject("Licensing")?!0:o)&&(e="DotNET methods"),o=!1,(o=validateNetObject("LicenseProviderAttribute")?!0:o)&&(e=addOption(e,"Provider attribute")),o=!1,o=!!validateNetObject("LicenseManager")||o)&&(e=addOption(e,"License manager")),!1),n=["nter serial ","erial key "," activate "," trial ","rong activation","rong licens","icense expire","valid license","icense key"," full version"," purchase a "],r=0;r<n.length;r++){var s=n[r]
if(PE.isSignaturePresent(0,PE.getSize(),"'"+s+"'")||PE.isSignaturePresent(0,PE.getSize(),"'"+generateUnicodeSignatureMask(s)+"'")){i=!0
break}}i&&(e=addOption(e,"Strings"))
var o=!1;(t=0!=(e=(o=PE.isLibraryPresentExp(/(Core\\Activation|Activation64)/i)?!0:o)?addOption(e,"Denuvo DRM"):e).length?!0:t)&&_setResult("~licensing","Contains","",PE.isVerbose()?e:"")}function scanForBadFileFormat_NET_and_Native(){log(logType.nothing,"Scanning for corrupted data...")
var e="",t=!1,i=!1,i=((i=PE.isEntryPointCorrect()?i:!0)&&(e=addOption(e,"EntryPoint")),!1),i=((i=PE.isSectionAlignmentCorrect()?i:!0)&&(e=addOption(e,"Section alignment")),!1),i=((i=PE.isFileAlignmentCorrect()?i:!0)&&(e=addOption(e,"File alignment")),!1),i=((i=PE.isHeaderCorrect()?i:!0)&&(e=addOption(e,"Header")),!1),i=((i=PE.isRelocsTableCorrect()?i:!0)&&(e=addOption(e,"Relocs")),!1),i=((i=PE.isImportTableCorrect()?i:!0)&&(e=addOption(e,"IAT")),!1),i=((i=PE_Cached.isDynamicLinkLibrary&&!PE.isExportTableCorrect()?!0:i)&&(e=addOption(e,"EAT")),!1),i=((i=PE.isResourcesTableCorrect()?i:!0)&&(e=addOption(e,"Resources")),!1),i=((i=!PE_Cached.isDotNet&&isNetMetaDataPresent()&&0==PE_Cached.numberOfUnmanagedImports?!0:i)&&(e=addOption(e,"DotNET headers/meta")),!1);(t=0!=(e=(i=PE_Cached.isDotNet&&!isAsciiString(PE.getNETVersion())?!0:i)?addOption(e,"DotNET CLR version"):e).length?!0:t)&&_setResult("~corrupted data","Generic","",PE.isVerbose()?e:"")}function scanForDebugData_NET_and_Native(){for(var e="",t=!1,i=!1,n=-1,r=0;r<PE_Cached.numberOfSections&&!i;r++){var n=r,s=PE.getSectionName(r);/(debug|^\.stab(str)?$)/i.test(s)&&(log(logType.any,'Debug section detected: "'+clearSectionName(PE.getSectionName(n))+'"'),i=!0)}i&&(e="Section #"+n+' ("'+clearSectionName(PE.getSectionName(n))+'")')
var o=!1,o=(!PE_Cached.isDotNet&&PE.isExportFunctionPresent("DotNetRuntimeDebugHeader")&&(log(logType.any,".NET Native debug symbols detected"),o=!0),o&&(e=addOption(e,"DotNET runtime header")),!1),o=(!PE_Cached.isDynamicLinkLibrary&&PE.isExportFunctionPresent("main")&&(log(logType.any,'The "--export-all-symbols" linker option was probably used'),o=!0),o&&(e=addOption(e,"Symbols exported")),!1),a=PE.findSignature(PE.getDosStubOffset()+PE.getDosStubSize(),PE.getSize()-PE.getOverlaySize(),"%% %% %% '.pdb' 00"),l=0,d=""
if(-1!==a){for(r=a;0<r;r--)if(0===PE.readByte(r)){l=r+1
break}null!==(d=(d=255<(d=PE.getString(l,256)).length?d.substring(0,255)+" . . .":d).replace(/[\n\r]/g,"")).match(/^[a-zA-Z]:\\/)&&(log(logType.any,'PDB absolute path: "'+d+'"'),o=!0)}o&&(e=addOption(e,"Absolute PDB path"))
var a=!1,c="",o=(d&&"."!==d[0]&&!o&&(c=validateSignature("00 52 53 44 53")?"Embedded":"Portable",log(logType.any,c+' PDB name: "'+d+'"'),a=!0),a&&(e=addOption(e,c+" PDB (release)")),!1)
PE_Cached.isDotNet&&validateNetObject("costura.costura.pdb.compressed")&&(log(logType.any,"Costura embedded PDB detected"),o=!0),(t=0!=(e=o?addOption(e,"Costura.Fody embedded PDB"):e).length?!0:t)&&_setResult("~debug data","Contains","",PE.isVerbose()?e:"")}function isVbNetStandardLibraryPresent(){return PE.isNetObjectPresent("Microsoft.VisualBasic")}function isJscriptNetStandardLibraryPresent(){return PE.isNetObjectPresent("Microsoft.JScript")}function isFrameworkComponent(){var e,t
return!(!PE_Cached.isDotNet||!PE_Cached.isDynamicLinkLibrary||PE_Cached.isNetGlobalCctorPresent)&&(e=PE_Cached.nameOfNetAssemblyName,t=PE_Cached.nameOfNetModuleName,6<=e.length)&&"System"===e.substring(0,6)&&t===e+".dll"}function validateSignature(e){var t=PE.findSignature(PE.getDosStubOffset()+PE.getDosStubSize(),PE.getSize()-PE.getOverlaySize(),e),i=-1!=t
return i&&(lastOffsetDetected="0x"+Number(t).toString(16),log(logType.any,"Pattern found: "+e)),i}function validateNetByteCode(e){for(var t=0;t<PE_Cached.numberOfSections;t++){var i=PE.getSectionFileOffset(t),n=PE.getSectionFileSize(t),i=PE.findSignature(i,i+n,e)
if(-1!=i)return lastOffsetDetected="0x"+Number(i).toString(16),log(logType.net,"ByteCode detected: "+e),!0}return!1}function validateNetObject(e){var t=PE.isNetObjectPresent(e)
return t&&log(logType.net,"Object present: "+e),t}function validateNetUnicodeString(e){var t=PE.isNetUStringPresent(e)
return t&&log(logType.net,'String present: "'+e+'"'),t}function validateGlobalUnicodeString(e){var t=-1!=PE.findSignature(PE.getDosStubOffset()+PE.getDosStubSize(),PE.getSize()-PE.getOverlaySize(),generateUnicodeSignatureMask(e))
return t&&log(logType.nothing,'Unicode string found: "'+e+'"'),t}function generateUnicodeSignatureMask(e){for(var t="",i=0;i<e.length;i++)t+=(0!=i?"00":"")+"'"+e[i]+"'"
return t}function isAllNetReferencesMissing(e){for(var t=0;t<e.length;t++)if(PE.isNetObjectPresent(e[t]))return!1
return!0}function isAllNetReferencesPresent(e){for(var t=0;t<e.length;t++)if(!PE.isNetObjectPresent(e[t]))return!1
return!0}function findAndMark(e,t){return PE.isSignatureInSectionPresent(0,"00'"+e+"'"+(t?"00":""))?e:""}function isNameObfuscated(e){if(e&&0!==e.length)if(-1!==e.indexOf(" "))for(var t=e.split(/\s+/),i=0;i<t.length;i++){var n=t[i]
if(0==i&&n.match(/^[A-Z]{3,}/))return!1
if(isTokenObfuscated(n))return log(logType.nothing,'Obfuscated string segment: "'+n+'" in "'+e+'"'),!0}else for(var r=0;r<e.length;r+=20){var s=e.substring(r,r+20)
if(isTokenObfuscated(s))return log(logType.nothing,'Obfuscated string chunk: "'+s+'" in "'+e+'"'),!0}return!1}function isTokenObfuscated(e){if(!e||e.length<7)return!1
if(e.match(/^\d{4}[-\/\.]\d{4}$/)||e.match(/^\d{1,2}[-\/\.]\d{1,2}[-\/\.]\d{2,4}$/)||e.match(/^\d{4}[-\/\.]\d{1,2}[-\/\.]\d{1,2}$/))return!1
if(e.match(/^v?\d+(\.\d+){1,4}$/i))return!1
if(e.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i))return!1
if(e.match(/^0x[0-9a-f]+$/i))return!1
if(e.match(/^\d+(\.\d+)?(bytes?|[kmgt]b)$/i))return!1
if(e.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/))return!1
if(e.match(/^[A-Z]{2,}[0-9]{1,3}$/))return!1
if(e.match(/^\d{6,12}$/))return!1
if(e.match(/(buildbot|builder|jenkins|gitlab|runner|relclient|steam|win32|win64|x64|x86)/i))return!1
for(var t={digits:0,lower:0,upper:0,special:0,transitions:0},i=[],n=0;n<e.length;n++){var r=e[n],s=i[i.length-1],r="0"<=r&&r<="9"?(t.digits++,"digit"):"a"<=r&&r<="z"?(t.lower++,"lower"):"A"<=r&&r<="Z"?(t.upper++,"upper"):(t.special++,"special")
i.push(r),s&&s!==r&&t.transitions++}var o=e.length,a=t.lower+t.upper
if(.6<t.transitions/o&&4<=t.digits)return!0
if(e.match(/^(?:[a-z]\d){4,}$/i))return!0
if(e.match(/^(?=\d|[a-z])(?=.*[a-z]\d[a-z])(?=(?:.*\d){4,})/i))return!0
if(e.match(/^[0-9a-f]{8,}$/i)&&!e.match(/^(dead|beef|cafe|babe|fade|deed|feed|face|decade|deface)$/i))return!0
if(e.match(/(.{2,3})\1{2,}/))return!0
if(e.match(/(?:[a-z]+\d+){4,}/i)&&4<=t.digits)return!0
if(e.match(/(?:[a-z]\d{3,}){2,}/i))return!0
if(e.match(/[bcdfghjklmnpqrstvwxz]{6,}/i)&&!e.match(/str|chr|thr|sch|scr|spr/i))return!0
for(var l={},n=0;n<e.length;n++){var d=e[n].toLowerCase()
if(-1!=="bcdfghjklmnpqrstvwxz".indexOf(d)&&(l[d]=(l[d]||0)+1,5<=l[d])&&e.length<15)return!0}if(e.match(/qwerty|asdfgh|zxcvbn|yuiop|hjkl|cvbnm|poiuy|lkjh/i))return!0
for(var c=0,n=1;n<e.length;n++){var u=e[n],g=e[n-1];("0"<=u&&u<="9"&&("a"<=g&&g<="z"||"A"<=g&&g<="Z")||("a"<=u&&u<="z"||"A"<=u&&u<="Z")&&("0"<=g&&g<="9"))&&c++}return 8<=c||7<=t.digits||4<=t.digits&&.4<t.digits/o||5<=t.digits&&3<=t.lower&&3<=t.upper||6<=t.digits&&5<=t.lower||5<=a&&5<=t.digits&&0===t.upper&&t.lower===a}function scanForObfuscations_Native(){log(logType.nothing,"Scanning for obfuscation...")
for(var e="",t=!1,i=!1,n=(1===PE_Cached.numberOfSections&&(log(logType.any,"Only one section found!"),i=!0),i&&(e=addOption(e,"Only one section")),!1),r="-=+~!@#$%^&*()\"â„–;%:?*():;,/\\|'`<> ",s=0;s<PE_Cached.numberOfSections&&!n;s++){var o=PE.getSectionName(s),a=((o.length<3||/^.\d.+/.test(o)&&".00cfg"!==o||" "===o[0])&&(n=!0),!1)
if(_isResultPresent("linker","GNU linker ld (GNU Binutils)"))if(PE.isSectionNamePresent(".build-id"))a=!0
else for(var l=1;l<10&&!a;l++)-1!=o.indexOf("/"+l)&&(a=!0)
if(a){n=!1
break}for(l=0;l<r.length&&!n;l++)-1!==o.indexOf(r[l])&&(n=!0)
isAsciiString(o)||(n=n||!0)}n&&(e=addOption(e,"Strange sections"))
var i=!1,d=!1
if(0===PE.getDosStubSize())i=!0
else for(var c=["This program cannot be run in DOS mode.","This program must be run under Windows","This program must be run under Win32","This program must be run under Win64","This program requires Win32","This is a Windows NT character-mode executable"],d=!0,l=0;l<c.length&&d;l++)PE.isSignaturePresent(PE.getDosStubOffset(),PE.getDosStubSize(),"'"+c[l]+"'")&&(d=!1)
i?e=addOption(e,"Missing DOS"):d&&(e=addOption(e,"Custom DOS"))
for(var u=!1,s=0;s<PE_Cached.numberOfUnmanagedImports&&!u;s++){var g=PE.getImportLibraryName(s).toLowerCase()
!(4<g.length&&"."===g[g.length-4]||!(u=!0))}u&&(e=addOption(e,"No extension import"))
for(var P=!1,s=0;s<PE_Cached.numberOfUnmanagedImports&&!P;s++){var p=PE.getImportLibraryName(s).toLowerCase()
4<p.length&&"ntoskrnl.exe"!==p&&".exe"===p.substr(p.length-4,4)&&(P=!0)}P&&(e=addOption(e,"EXE in imports"))
for(var E=!1,s=0;s<PE_Cached.numberOfUnmanagedResources&&!E;s++)-1===PE.getResourceOffsetByNumber(s)&&(E=!0)
E&&(e=addOption(e,"Unreadable resources"))
var i=!1,i=((i=PE_Cached.isDynamicLinkLibrary&&PE.isExportFunctionPresentExp(/^(Start|main|_start|(w)?WinMain|EntryPoint)$/)?!0:i)&&(e=addOption(e,"EXE as DLL")),!1),i=((i=0<PE_Cached.numberOfSections&&".text"!==PE.section[0].Name&&".textbss"!==PE.section[0].Name&&(PE.isSectionNamePresent(".text")||PE.isSectionNamePresent(".textbss"))&&".code"===PE.section[0]?!0:i)&&(e=addOption(e,'".text" section is not first')),!1),m=!1,i=(-1!==PE_Cached.indexOfImportsSection||PE_Cached.isDynamicLinkLibrary?-1===PE_Cached.indexOfImportsSection||PE_Cached.numberOfUnmanagedImports||(m=!0):i=!0,i?e=addOption(e,"No IAT"):m&&(e=addOption(e,"Empty IAT")),!1),m=!1,i=(PE_Cached.isDynamicLinkLibrary&&(-1===PE_Cached.indexOfExportsSection&&PE.getAddressOfEntryPoint()?i=!0:-1!==PE_Cached.indexOfExportsSection&&0===PE_Cached.numberOfUnmanagedExports&&(m=!0)),i?e=addOption(e,"No EAT"):m&&(e=addOption(e,"Empty EAT")),!1),h=((i=PE_Cached.isDynamicLinkLibrary&&PE.getAddressOfEntryPoint()&&-1===PE_Cached.indexOfImportsSection&&-1===PE_Cached.indexOfExportsSection?!0:i)&&(e=addOption(e,"No IAT and EAT")),!1)
if(PE_Cached.isArchX86){var m=["MOV ESI, ESI","XCHG EAX, EAX","XCHG EBX, EBX","XCHG ECX, ECX","XCHG EDX, EDX","XCHG EDI, EDI","LEA EAX, [EAX]","LEA ESI, [ESI]","LEA ESI, CS:[ESI]"],i=["MOV RSI, RSI","XCHG RAX, RAX","XCHG RBX, RBX","XCHG RCX, RCX","XCHG RDX, RDX","XCHG RDI, RDI","LEA RAX, [RAX]","LEA RSI, [RSI]","LEA RSI, CS:[RSI]"],S=["XCHG AX, AX","XCHG BX, BX","XCHG CX, CX","XCHG DX, DX","XCHG SI, SI","XCHG DI, DI","XCHG BP, BP"].concat(PE_Cached.is64bit?i:m)
if("NOP"===getFirstEpAsmOpCode())h=!0
else for(s=0;s<S.length&&!h;s++)PE_Cached.firstEpAsmInstruction===S[s]&&(h=!0)}else{var i=["NOP","MOV R0, R0","MOV R1, R1","MOV R2, R2","MOV R3, R3","MOV R4, R4","MOV R5, R5","MOV R6, R6","MOV R7, R7","MOV R8, R8","MOV R9, R9","MOV R10, R10","MOV R11, R11","MOV R12, R12","MOV R13, R13","MOV R14, R14","MOV R15, R15"],m=["NOP","MOV X0, X0","MOV X1, X1","MOV X2, X2","MOV X3, X3","MOV X4, X4","MOV X5, X5","MOV X6, X6","MOV X7, X7","MOV W0, W0","MOV W1, W1","MOV W2, W2","MOV W3, W3"],x=PE_Cached.is64bit?m:i
if("NOP"===getFirstEpAsmOpCode())h=!0
else for(s=0;s<x.length&&!h;s++)PE_Cached.firstEpAsmInstruction===x[s]&&(h=!0)}h&&(e=addOption(e,"Nop at EP"))
var f=!1
if(PE_Cached.isArchX86&&!PE_Cached.isDynamicLinkLibrary)for(s=0;s<32&&!f;s++){if(!(b=getAsmInstructionByIndex(s)))break
if("CALL"===getAsmOpCode(b)){for(var _=PE.getAddressOfEntryPoint(),M=0;M<s;M++)_=PE.getDisasmNextAddress(_)
var X=PE.VAToOffset(_)
PE.compare("E8 00 00 00 00",X)&&(log(logType.any,"Stack-push address near EP found at offset: 0x"+X.toString(16)),f=!0)}}f&&(e=addOption(e,"Stack-push address near EP"))
var y=!1
if(PE_Cached.isArchX86&&!PE_Cached.isDynamicLinkLibrary)for(var b,s=0;s<15&&!y;s++){if(!(b=getAsmInstructionByIndex(s)))break
"CPUID"===getAsmOpCode(b)&&(log(logType.any,"CPUID near EP found at instruction index: "+s),y=!0)}y&&(e=addOption(e,"Cpuid near EP"))
for(var m=!1,i=(PE.isTLSPresent()&&(PE_Cached.isArchX86?(/^INT( )?3$/.test(getAsmOpCode(PE_Cached.firstEpAsmInstruction))||/^RET( \d+)?$/.test(getAsmOpCode(PE_Cached.firstEpAsmInstruction)))&&(m=!0):(/^BKPT/.test(getAsmOpCode(PE_Cached.firstEpAsmInstruction))||/^BRK/.test(getAsmOpCode(PE_Cached.firstEpAsmInstruction))||/^RET/.test(getAsmOpCode(PE_Cached.firstEpAsmInstruction))||/^BX( )?LR$/.test(PE_Cached.firstEpAsmInstruction))&&(m=!0)),m&&(e=addOption(e,"TLS hidden EP")),!1),m=((i=PE_Cached.isArchX86&&(PE.compareEP("EB $$ EB")||PE.compareEP("EB $$ E9")||PE.compareEP("E9 ## ## ## ## EB")||PE.compareEP("E9 ## ## ## ## E9"))?!0:i)&&(e=addOption(e,"Proxy jmp at EP")),!1),C=((m=h||-1===getEpAsmPattern(!0,5).indexOf(getInstructionsAsmPattern(["NOP","NOP"]))?m:!0)&&(e=addOption(e,"Nop EP padding")),!1),v=-1,O=-536870912,w=32|O,s=0;s<PE_Cached.numberOfSections&&!C;s++){var V=PE.section[s].Characteristics;(V&O)!=O&&(V&w)!=w||(C=!0,v=s)}C&&(e=addOption(e,"Section #"+v+' ("'+clearSectionName(PE.getSectionName(v))+'") has RWX'))
for(var N=!1,A=-1,H=PE.getAddressOfEntryPoint()-PE.getImageBase(),s=0;s<PE_Cached.numberOfSections&&!N;s++){var $=PE.getSectionVirtualAddress(s),j=PE.getSectionVirtualSize(s)
$<=H&&H<$+j&&(A=s,PE.compare("00 00 00",PE.getSectionFileOffset(A)))&&(N=!0)}N&&(e=addOption(e,"EP-section #"+A+' ("'+clearSectionName(PE.getSectionName(A))+'") zero padding'))
var i=!1,m=((i=20<PE_Cached.numberOfSections?!0:i)&&(e=addOption(e,"Too many sections")),!1),i=(_isResultPresent("linker","Turbo Linker")||(i=getOptHeaderOffset()+(PE_Cached.is64bit?112:96)+96,-1!==PE_Cached.indexOfImportsSection&&0===PE.read_int32(i)&&(m=!0)),m&&(e=addOption(e,"IAT directory empty")),!1),k=((i=PE.isSectionNamePresentExp(/^\.[xp]data$/)&&(m=getOptHeaderOffset()+(PE_Cached.is64bit?136:120),0===PE.read_int32(m))&&0===PE.read_int32(m+4)?!0:i)&&(e=addOption(e,"Exceptions directory empty")),!1)
if(0<PE_Cached.numberOfUnmanagedExports)for(s=0;s<PE_Cached.numberOfUnmanagedExports&&!k;s++){var D=PE.getExportFunctionName(s)
D&&(/^\d/.test(D)||!isAsciiString(D)||!isItemMangled(D)&&isNameObfuscated(replaceAllInString(D,"_"," ")))&&(k=!0)}k&&(e=addOption(e,"Strange exports"))
for(var I=!1,U="=~!@#$%^&*()\"â„–;%:?*():;,|'`<> ",s=0;s<PE_Cached.numberOfUnmanagedImports&&!I;s++){var R=PE.getImportLibraryName(s)
if(isAsciiString(R))for(var T=0;T<U.length&&!I;T++)isAsciiString(R)&&-1===R.indexOf(U[T])||(I=!0)
else 0!==R.indexOf("MZ")&&(I=!0)}I&&(e=addOption(e,"Strange imports"))
for(var F=!1,s=0;s<PE_Cached.numberOfUnmanagedResources&&!F;s++){var B=PE.getResourceNameByNumber(s)
!B||isAsciiString(B)&&!isNameObfuscated(B)||(log(logType.any,"Strange resource name: "+B),F=!0)}F&&(e=addOption(e,"Strange resources"))
m=!1,(m=0===PE.getMajorLinkerVersion()&&0===PE.getMinorLinkerVersion()?!0:m)&&(e=addOption(e,"Zero linker version")),i=!1,(i=isNetMetaDataPresent()&&0<PE_Cached.numberOfUnmanagedImports?!0:i)&&(e=addOption(e,"DotNET meta")),m=!1
if((m=PE.isFunctionPresent("_CorExeMain")||PE.isFunctionPresent("_CorDllMain")?!0:m)&&(e=addOption(e,"DotNET runtime attach")),PE.section[".asmg"]||PE.section.ASMGUARD)for(var L=0;L<3;L++)_removeResult("packer",["UPX","MPRESS","EP:MPRESS"][L]);(t=0!=e.length?!0:t)&&_setResult("~protection","Generic","",PE.isVerbose()?e:"")}function isArchX86(){switch(PE.getOperationSystemOptions().split(",")[0]){case"I386":case"AMD64":return!0
case"ARM":case"ARMNT":case"THUMB":return!1
default:return}}var _patternSplitter="|"
function getEpAsmPattern(e,t){for(var i=_patternSplitter,n=PE.getAddressOfEntryPoint(),r=0;r<t;r++){1<=r&&(n=PE.getDisasmNextAddress(n))
var s=PE.getDisasmString(n)
i+=(e?getAsmOpCode(s):s)+_patternSplitter}return i}var epAsmInstructions=[]
function getAsmInstructionByIndex(e){if(void 0!==epAsmInstructions[e])return epAsmInstructions[e]
for(var t=PE.getAddressOfEntryPoint(),i=0;i<=e;i++)if(1<=i&&(t=PE.getDisasmNextAddress(t)),void 0===epAsmInstructions[i]&&(epAsmInstructions[i]=PE.getDisasmString(t)),i===e)return epAsmInstructions[e]}function getInstructionsAsmPattern(e){return _patternSplitter+(Array.isArray(e)?e.join(_patternSplitter):e)+_patternSplitter}function getFirstEpAsmInstruction(){return getAsmInstructionByIndex(0)}function getAsmOpCode(e){return-1!==e.indexOf(" ")?e.split(" ")[0]:e}function getFirstEpAsmOpCode(){return getAsmOpCode(PE_Cached.firstEpAsmInstruction)}function isItemMangled(e){return!(e.length<=5)&&("?"===e[0]&&(-1!==e.indexOf("@@")||"?"===e[1])||"_Z"===e.substring(0,2)||"@"===e[0]&&-1!==e.indexOf("$")||"$"===e[0]&&("s"===e[1]||"S"===e[1]))}function getManglerInfoByMangledItem(e){if(isItemMangled(e))return"?"===e[0]?{compiler:"Microsoft Visual C++",language:"C++"}:"_Z"===e.substring(0,2)?{compiler:"MinGW",language:"C++"}:"@"===e[0]&&-1!==e.indexOf("$")?{compiler:"Borland C++",language:"C++"}:"$"!==e[0]||"s"!==e[1]&&"S"!==e[1]?void 0:{compiler:"Swift",language:"Swift"}}function getNameOfMangledItem(e){if(isItemMangled(e)){if("?"===e[0]){if("?"!==e[1])return e.split("?")[1].split("@")[0]
if("?"===e[1]){if("$"===e[2])return e.split("$")[1].split("@")[0]
if(-1!==e.indexOf("?$")){var t=e.match(/\?\?\d\?\$([^@]+)@/)
if(t)return t[1]}if("_"===e[2])if(3<=(g=e.split("?")).length)return 1<(a=g[2].split("@")[0]).length&&/[EGR]/.test(a[1])?a:0===(t=a.substring(2)).indexOf("_")?t.substring(1):t
if(/[0-9A-D]/.test(e[2]))if(3<=(g=e.split("?")).length)return 1===(a=g[2].split("@")[0]).length&&/[0-9A-D]/.test(a[0])?{2:"operator_new",3:"operator_delete",4:"operator_assign",5:"operator_shift_left",6:"operator_shift_right",8:"operator_equal",9:"operator_not_equal",A:"operator_subscript",B:"operator_not",C:"operator_cast",D:"operator_cast_const"}[a[0]]||"operator_unknown":a.substring(1)
if(3<=(g=e.split("?")).length)return 0<(o=g[2].split("@")[0]).length&&/[0-9A-D]/.test(o[0])?o.substring(1):o}}if("_Z"===e.substring(0,2))if("S"===e[2]&&"t"===e[3]){t=e.match(/_ZSt(\d+)(.+)/)
if(t)return t[2].substring(0,parseInt(t[1],10))}else if("N"===e[2]){for(var i=[],n=e.substring(3);0<n.length&&"E"!==n[0]&&/^\d/.test(n);){var r=n.match(/^(\d+)/)
if(!r)break
var s=parseInt(r[1],10),r=r[1].length
if(!(n.length>=r+s))break
var o=n.substring(r,r+s)
i.push(o),n=n.substring(r+s)}if(0<i.length)return i[i.length-1]}else{var a=e.match(/_Z(\d+)(.+)/)
if(a)return t=parseInt(a[1],10),a[2].substring(0,t)}if("@"===e[0]){if(2===(g=e.split("@")).length)return g[1].split("$")[0]
if(3<=g.length)return"$bctr"===(a=g[2].split("$")[0])?g[1]:"$bdtr"===a?"~"+g[1]:a}if("$"===e[0]&&("s"===e[1]||"S"===e[1])){var l=2,d=[]
for(var c=50;l<e.length&&0<c--;){var u=e[l]
if(/^\d/.test(u)){m=E=void 0
P=(p=l)>=(P=e).length||!/^\d/.test(P[p])||!(m=P.substring(p).match(/^(\d+)/))||(E=parseInt(m[1],10),p+(m=m[1].length)+E>P.length)?null:{name:P.substring(p+m,p+m+E),nextPos:p+m+E}
if(P){d.push(P.name),l=P.nextPos
continue}}if(!/^[xqyz]/.test(u)){if(/^[a-zA-Z]$/.test(u)){p=l+1<e.length?e[l+1]:""
if("S"===u&&/^[a-zA-Z]/.test(p)){m=l+2<e.length?e[l+2]:""
if(/^[a-z]$/.test(m)){E=l+3<e.length?e[l+3]:""
if(/^\d/.test(E)){l+=3
continue}}if(/^\d/.test(m)){l+=2
continue}}if(/^\d/.test(p)){l++
continue}}break}for(l++;l<e.length&&/^[xqyzd_0-9]/.test(e[l]);)l++}if(0<d.length)return d[d.length-1]
if(l<e.length&&"S"===e[l]&&l+1<e.length){var t=e.substring(l,l+2),g={Sa:"Array",Sb:"Bool",Sc:"UnicodeScalar",Sd:"Double",Sf:"Float",Sg:"Optional",Sh:"Set",Si:"Int",SL:"Collection",Sl:"Slice",Sm:"Mirror",Sn:"Numeric",So:"ObjectiveC",Sp:"UnsafePointer",Sq:"Optional",SR:"Sequence",Sr:"UnsafeRawPointer",Ss:"String",SS:"String",St:"Range",ST:"Equatable",Su:"UInt",Sv:"UnsafeRawBufferPointer",Sw:"UnsafeBufferPointer",Sx:"Strideable",SY:"RawRepresentable",Sy:"RawRepresentable",Sz:"BinaryInteger",SD:"Dictionary",SE:"Encodable",SH:"Hashable",Sk:"KeyPath",SK:"KeyPath"}
if(g[t])return g[t]}}var P,p,E,m}return e}function validateImportHashes(e){for(var t=0;t<e.length;t++){var i=e[t][2],n=e[t][3]
if(Array.isArray(n)){for(var r=0;r<n.length;r++)if(PE.isImportPositionHashPresent(i,n[r]))return e[t]}else if(PE.isImportPositionHashPresent(i,n))return e[t]}return null}function validateSectionNames(e){for(var t=0;t<e.length;t++){var i=e[t][2]
if(Array.isArray(i)){for(var n=0;n<i.length;n++)if("string"==typeof i[n]&&PE.isSectionNamePresent(i[n])||i[n]instanceof RegExp&&PE.isSectionNamePresentExp(i[n]))return e[t]}else if("string"==typeof i&&PE.isSectionNamePresent(i)||i instanceof RegExp&&PE.isSectionNamePresentExp(i))return e[t]}return null}function validateResourceNames(e){for(var t=0;t<e.length;t++){var i=e[t][2]
if(Array.isArray(i)){for(var n=0;n<i.length;n++)if("string"==typeof i[n]&&PE.isResourceNamePresent(i[n])||i[n]instanceof RegExp&&PE.isResourceNamePresentExp(i[n]))return e[t]}else if("string"==typeof i&&PE.isResourceNamePresent(i)||i instanceof RegExp&&PE.isResourceNamePresentExp(i))return e[t]}return null}function getOptHeaderOffset(){return PE.read_int32(60)+4+20}function isNetMetaDataPresent(){var e,t=getOptHeaderOffset(),t=PE_Cached.is64bit?(e=t+108,t+224):(e=t+92,t+208)
return!(t+8>PE.getSize()||e+4>PE.getSize()||PE.read_int32(e)<15||(e=PE.read_int32(t),t=PE.read_int32(t+4),0===e)||0===t)}function isCompilerDetected(){return 0<_getNumberOfResults("compiler")||0<_getNumberOfResults("~compiler")}function isLinkerDetected(){return 0<_getNumberOfResults("linker")||0<_getNumberOfResults("~linker")}function scanForLanguagesAndCompilers_NET_and_Native(){log(logType.nothing,"Scanning for programming language...")
for(var e=_isLangPresent("C/C++"),t=[["C++","cpp"],["Rust","rs"],["Java","jar"],["Python","pyd"],["Kotlin","kt"]],i=0;i<t.length;i++){var n=t[i][0],r=t[i][1]
PE.isSignaturePresent(0,PE.getSize(),"%% %% %% %% %% %% %% %% '."+r+"' 00")&&(log(logType.any,"Lines of ."+r+" files ("+n+") detected"),_setLangByHeur(n))}!_isLangDetected("C++")&&PE.isSignaturePresent(0,PE.getSize(),"%% %% %% %% %% %% %% %% %% %% '.c' 00")&&(log(logType.any,"Lines of .c files (C) detected (not a C++)"),_setLangByHeur("C"))
for(i=0;i<PE_Cached.numberOfUnmanagedResources;i++){var s=PE.getResourceOffsetByNumber(i)
if(-1!==s){s=PE.getString(s,64)
if("object"===s.split(" ")[0]&&-1!==s.indexOf(": ")){_setLangByHeur("Object Pascal")
break}}}for(var o=!1,a=!1,i=0;i<PE_Cached.numberOfUnmanagedImports;i++){for(var l=PE.getImportLibraryName(i).toLowerCase(),d=0;d<PE.getNumberOfImportThunks(i)&&!o;d++){var c=PE.getImportFunctionName(i,d)
isItemMangled(c)&&(log(logType.any,'Mangler detected -> "'+l+'", at function "'+getNameOfMangledItem(c)+'"'),g=!1,isCompilerDetected()||(P=getManglerInfoByMangledItem(c))&&(_setResult("~compiler",P.compiler,"",""),_isLangDetected()||_setLangByHeur(P.language),"C++"!==P.language)&&(g=!0),o=!g)}-1===l.indexOf("++")&&-1===l.indexOf("cpp")&&-1===l.indexOf("msvcp")||(log(logType.any,'C++ library present -> "'+l+'"'),o=!0),-1===l.indexOf("msvcr")&&-1===l.indexOf("crtdll")||(log(logType.any,'C library present -> "'+l+'"'),a=!0)}for(var u=0;u<PE_Cached.numberOfUnmanagedExports&&!o;u++){var g,P,p=PE.getExportFunctionName(u)
p&&isItemMangled(p)&&(log(logType.any,'Mangler detected at exported item "'+getNameOfMangledItem(p)+'"'),g=!1,isCompilerDetected()||(P=getManglerInfoByMangledItem(p))&&(_setResult("~compiler",P.compiler,"",""),_isLangDetected()||_setLangByHeur(P.language),"C++"!==P.language)&&(g=!0),o=!g)}if(!isCompilerDetected()&&PE_Cached.isRichSignaturePresent)for(var E=0;E<PE_Cached.numberOfRichIDs;E++){var m=PE.getRichID(E),h=PE.getRichVersion(E),S=PE.getRichCount(E)
if(13===m&&9782===h&&1===S){_setResult("~compiler","Microsoft Visual Basic","6.0",""),_setLangByHeur("VB")
break}if(259===m){_setResult("~compiler","MASM","","")
break}}if(!isCompilerDetected())for(var f=[".text$mn",".rdata$zzzdbg",".rtc$IAA",".rtc$IZZ",".rtc$TAA",".rtc$TZZ","il2cpp"],i=0;i<f.length;i++)if(PE.isSectionNamePresent(f[i])){_setResult("~compiler","IL2CPP Technology","",""),_setLangByHeur("Native MSIL/C#")
break}var _,y=!a&&!o,b=PE.getMajorLinkerVersion(),C=PE.getMinorLinkerVersion(),v=(isCompilerDetected()||isLinkerDetected()||PE_Cached.isDotNet||(v=PE.section[".eh_frame"],_=PE.section[".build-id"],v||_||!(PE_Cached.isRichSignaturePresent||PE.compare("'MZ'90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000....00000E1FBA0E00B409CD21B8014CCD21'This program cannot be run in DOS mode.\r\r\n$'00000000")||PE.compare("'MZ'90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000....000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")||PE.isSectionNamePresent(".00cfg"))?v||_||PE.isSectionNamePresent(".CRT")&&PE.isSectionNamePresent(".rdata")&&PE.isSectionNamePresent(".xdata")&&PE.isSectionNamePresent(".idata")&&(PE.isSectionNamePresent(".tls")||PE.isSectionNamePresent(".bss"))||PE.isSectionNamePresent(".buildid")?(_setResult("~compiler","MinGW","",""),!_isLangDetected()&&y&&_setLangByHeur("C/C++")):PE.isSectionNamePresent(".flat")&&!o&&(_setResult("~compiler","FASM","",""),_setLangByHeur("ASMx"+(PE_Cached.is64bit?"64":"86"))):((PE.isSectionNamePresent(".gfids")||PE.isSectionNamePresent(".giats")||PE.isSectionNamePresent(".gljmp"))&&_setResult("~tool","Microsoft Visual Studio","",""),_setResult("~linker","Microsoft Linker",0!==b?b+"."+C:"",""),_setResult("~compiler","Microsoft Visual C/C++","",""),!_isLangDetected()&&y&&(isNetMetaDataPresent()?_setLangByHeur("MSIL/C/C++"):_setLangByHeur("C/C++")))),PE.section[".rdata"])
v&&e&&PE.isSignaturePresent(v.FileOffset,v.FileSize,generateUnicodeSignatureMask("Visual C++"))&&(log(logType.any,"Embedded Visual C++ Runtime detected."),o=!0),o||e&&PE.isSignaturePresent(0,PE.getSize()-PE.getOverlaySize(),"' C++ '")?_setLangByHeur("C++"):!_isLangPresent("C++")&&a&&(PE.isFunctionPresent("_iob")||PE.isFunctionPresent("printf")||PE.isFunctionPresent("malloc")||PE.isFunctionPresent("memset"))?_setLangByHeur("C"):PE.isLibraryPresentExp(/^api-ms-win-crt*/i)||PE.isSectionNamePresent(".msvcjmc")?_setLangByHeur("C/C++"):_isLangDetected()||_getNumberOfResults("compiler")||PE_Cached.isDotNet||_getNumberOfResults("protector")||_getNumberOfResults("cryptor")||_getNumberOfResults("~cryptor")||_getNumberOfResults("packer")||_getNumberOfResults("~packer")||_setLangByHeur("ASMx"+(PE_Cached.is64bit?"64":"86"))}function _setLangByHeur(e){log(logType.any,e+" language detected!"),_setLang(e,heurLabel)}function addOption(e,t){return e&&(e+=" + "),e+=t}function log(e,t){if(t){/\r|\n|\t/.test(t)&&(t=t.replace(/[\r\n\t]+/g," ").replace(/\s+/g," ").trim())
var i=""
switch(-2!==e&&(i=heurLabel),-2<e&&0!==e&&(i+="/"),e){case-2:i="!"
break
case-1:i+="About"
break
case 1:i+="Any"
break
case 2:i+=".NET"}"undefined"!=typeof _log?_log("["+i+"] "+t):_error("Unable to write log message")}}function scanForMaliciousCode_NET_and_Native(){log(logType.nothing,"Scanning for malicious code...")
var e,t=[],i="May be infected, be careful!"
if(PE_Cached.isDotNet){for(var n,r=["System.Diagnostics","System.IO.Compression","user32","kernel32","ntdll"],s=0,o=0;o<r.length;o++)n="00'"+r[o]+"'00",PE.isSignatureInSectionPresent(0,n)&&s++
if(PE.isSignatureInSectionPresent(0,"00'System.Net.Sockets'00")&&2<=s)for(var a=[{type:"NjRAT",edition:"0.7D Green Edition",references:["w","System.Drawing","System.Windows.Forms","System.Runtime.InteropServices","avicap32.dll","capGetDriverDescriptionA","kernel32","KERNEL32.DLL","ntdll","user32","GetWindowText","EnumChildWindows","SendMessage","GetWindowTextLength","user32.dll","winmm.dll"],isVbNet:!0},{type:"NjRAT",edition:"0.7D Lime Edition",references:["Stub","System.Drawing","System.Windows.Forms","System.Runtime.InteropServices","avicap32.dll","capGetDriverDescriptionA","kernel32","ntdll","NtSetInformationProcess","user32","MapVirtualKey","ToUnicodeEx","GetKeyboardState","user32.dll","wintrust.dll"],isVbNet:!0},{type:"NjRAT",edition:"0.7D",references:["Stub","System.Drawing","System.Windows.Forms","System.Runtime.InteropServices","avicap32.dll","capGetDriverDescriptionA","kernel32","ntdll","NtSetInformationProcess","user32","MapVirtualKey","ToUnicodeEx","GetKeyboardState","user32.dll"],isVbNet:!0},{type:"NjRAT",edition:"0.11G-0.12G",references:["k","System.Drawing","System.Windows.Forms","System.Runtime.InteropServices","avicap32.dll","capGetDriverDescriptionA","kernel32","ntdll","NtsetInformationProcess","user32","MapVirtualKey","ToUnicodeEx","GetKeyboardState","GetForegroundWindow","GetWindowTextLengthA","GetAsyncKeyState","user32.dll"],isVbNet:!0},{type:"NjRAT",edition:"0.7D Danger Edition",references:["Stub","System.Drawing","System.Windows.Forms","System.Runtime.InteropServices","avicap32.dll","capGetDriverDescriptionA","Kernel32.dll","KERNEL32.DLL","user32","GetWindowText","EnumChildWindows","GetForegroundWindow","SendMessage","GetWindowTextLength","SetWindowPos","user32.dll","winmm.dll"],isVbNet:!0},{type:"NjRAT",edition:"0.7D Golden Edition",references:["Stub","System.Drawing","System.Windows.Forms","System.Runtime.InteropServices","avicap32.dll","kernel32","Kernel32.dll","ntdll","NtSetInformationProcess","user32","user32.dll","GetForegroundWindow","GetWindowTextA","winmm.dll"],isVbNet:!0},{type:"XWorm",edition:"3.0-5.0",references:["System.Core","System.Drawing","System.Management","System.Windows.Forms","System.Runtime.InteropServices","avicap32.dll","capCreateCaptureWindowA","kernel32.dll","SetThreadExecutionState","user32.dll","GetForegroundWindow","GetWindowText"],isVbNet:!0},{type:"VenomRAT",edition:"6.X",references:["Microsoft.CSharp","System.Core","System.Drawing","System.Management","System.Windows.Forms","System.Runtime.InteropServices","kernel32.dll","SetThreadExecutionState","ntdll.dll","RtlSetProcessIsCritical","user32.dll","GetWindowText","GetForegroundWindow"],isVbNet:!0},{type:"RevengeRAT",edition:"0.3",references:["System.Management","System.Windows.Forms","avicap32.dll","capGetDriverDescriptionA","kernel32","psapi","EmptyWorkingSet","user32","GetWindowText"],isVbNet:!0},{type:"Webremote TorCT",edition:void 0,references:["System.Windows.Forms","avicap32.dll","capGetDriverDescriptionA","capCreateCaptureWindowA","user32","SendMessage","SetWindowPos","DestroyWindow","user32.dll","GetForegroundWindow","GetWindowText"],isVbNet:!0},{type:"NjRAT",edition:void 0,references:["System.Drawing","System.Windows.Forms","GetForegroundWindow","System.Runtime.InteropServices","System.Security.Cryptography","GetWindowText","avicap32.dll","A","kl","OK"],isVbNet:!0},{type:"NjRAT",edition:void 0,references:["System.Drawing","System.Windows.Forms","GetForegroundWindow","System.Runtime.InteropServices","System.Security.Cryptography","GetWindowText","avicap32.dll","A","kl","USB"],isVbNet:!0}],l=0;l<a.length;l++){for(var d=a[l],c=!0,u=0;u<d.references.length&&c;u++)n="00'"+d.references[u]+"'00",PE.isSignatureInSectionPresent(0,n)||(c=!1)
if(c&&(!d.isVbNet||PE_Cached.isVbNetStandardLibraryPresent)){t.push({type:d.type,version:d.edition||"",details:""})
break}}var g="??"+(g=generateUnicodeSignatureMask("|'|'|")+"00").substring(2,g.length)
0===t.length&&("w"===PE_Cached.nameOfNetAssemblyName||"w.exe"===PE_Cached.nameOfNetModuleName||"k"===PE_Cached.nameOfNetAssemblyName||"k.exe"===PE_Cached.nameOfNetModuleName||PE.isNetObjectPresent("njLogger")||PE.isNetUStringPresent("|PWD| ")||PE.isSignatureInSectionPresent(0,g))&&t.push({type:"NjRAT",version:"",details:""}),0===t.length&&PE.isNetObjectPresent("avfucker")&&t.push({type:"RAT Injector",version:"",details:""}),0!==t.length||"AsyncClient"!==PE_Cached.nameOfNetAssemblyName&&"AsyncClient.exe"!==PE_Cached.nameOfNetModuleName&&!PE.isNetObjectPresent("Pastebin")||t.push({type:"AsyncRAT",version:"",details:""}),0!==t.length||!PE.isNetObjectPresent("ClientLoaderForm")&&"NanoCore Client"!==PE_Cached.nameOfNetAssemblyName||t.push({type:"NanoCore RAT",version:"",details:""}),0!==t.length||"Orcus.exe"!==PE_Cached.nameOfNetModuleName&&!PE.isNetObjectPresent("Orcus.Connections")||t.push({type:"Orcus RAT",version:"1.3-1.9.1",details:""}),0===t.length&&"Client.exe"===PE_Cached.nameOfNetModuleName&&PE.isNetObjectPresent("System.Security.Cryptography.X509Certificates")&&t.push({type:"Liberium RAT",version:"",details:""}),0===t.length&&PE.isNetObjectPresent("button_unlock_Click")&&t.push({type:"Liberium WinLocker",version:"",details:""}),0===t.length&&"Kheir.exe"===PE_Cached.nameOfNetModuleName&&t.push({type:"jnRAT",version:"",details:""}),0===t.length&&"QatarC.exe"===PE_Cached.nameOfNetModuleName&&t.push({type:"Qatar RAT",version:"1.2",details:""}),0===t.length&&"Client.exe"===PE_Cached.nameOfNetModuleName&&PE.isNetObjectPresent("fusion")&&t.push({type:"DarkRAT",version:"",details:""}),0===t.length&&PE.isNetObjectPresent("tosuck")&&t.push({type:"ICARUS Evil Worm RAT",version:"",details:""}),0===t.length&&PE.isNetObjectPresent("isVM_by_wim_temper")&&t.push({type:"NonEuclid RAT",version:"",details:""}),0===t.length&&PE.isNetObjectPresent("LZLoader")&&PE.isNetObjectPresent("Injector")&&t.push({type:"Imminent Monitor RAT",version:"",details:""}),0===t.length&&(PE.isSignatureInSectionPresent(0,"00"+generateUnicodeSignatureMask(" RAT")+"00 **")||PE.isNetObjectPresent("AntiTaskManager")||PE.isNetObjectPresent("BlockAvSites")||PE.isNetObjectPresent("UpdaterEXE")||PE.isNetObjectPresent("System.Net.Sockets")&&PE.isNetObjectPresent("GetForegroundWindow")&&PE.isNetObjectPresent("GetWindowText")&&(PE.isSignatureInSectionPresent(0,generateUnicodeSignatureMask("AntivirusProduct"))||PE.isSignatureInSectionPresent(0,generateUnicodeSignatureMask("DisableTaskMgr")))||PE.isNetObjectPresent("GetForegroundWindow")&&PE.isNetObjectPresent("GetWindowText")&&PE.isNetObjectPresent("NtSetInformationProcess"))&&t.push({type:"RAT",version:"",details:"General signs"})}0===t.length&&(PE.isNetObjectPresent("potentiallyVulnerablePasswords")||PE.isNetObjectPresent("ScanGeckoBrowsersPaths")||PE.isNetObjectPresent("ScannedWallets")||PE.isNetObjectPresent("GetPasswords")||PE.isNetObjectPresent("ScanSteam")||PE.isNetObjectPresent("GetCookies"))&&t.push({type:"Stealer",version:"",details:"General signs"}),0===t.length&&PE.isSectionNamePresent(".rmnet")&&t.push({type:"Ramnit",version:"",details:"infected"}),0===t.length&&PE.compareEP("558B EC83 C4 E033 C089 45 E089 45 E889 45 E489 45 ECB8 54 80 40 00E8 12 BE FF FF33 C05568 20 82 40 0064 FF 3064 89 20B8 A8 91 40 00B9 0B 00 00 00")&&t.push({type:"Neshta",version:"",details:"infected"}),0===t.length&&PE.compareEP("68 .. .. .. ..68 00 00 00 0068 .. .. .. ..E8 .. .. .. ..83 C4 0C68 00 00 00 00")&&(g="",PE.isImportPositionHashPresent(0,2994531744)&&PE.isImportPositionHashPresent(1,2810025820)?g="1.0":PE.isImportPositionHashPresent(0,502033476)&&PE.isImportPositionHashPresent(1,4058866520)&&(g="1.2"),g)&&t.push({type:"ConsoleDevil RAT",version:g,details:""}),0===t.length&&PE.compareEP("B8 00 04 40 00FF D06A 00")&&PE.isImportPositionHashPresent(0,3174455850)&&t.push({type:"Poison Lvy RAT",version:"",details:""}),0===t.length&&PE.isExportFunctionPresent("Ip")&&t.push({type:"Gh0st RAT",version:"",details:""}),(0===t.length&&PE.isImportPositionHashPresent(0,4084592131)&&PE.isImportPositionHashPresent(1,1615048040)&&PE.isImportPositionHashPresent(2,1239987933)||PE.isImportPositionHashPresent(0,391052164)&&PE.isImportPositionHashPresent(1,1258175057)&&PE.isImportPositionHashPresent(2,1033520080))&&t.push({type:"DarkComet RAT",version:"5.3",details:""}),0===t.length&&1===PE_Cached.numberOfUnmanagedImports&&(e=g=!1,PE.isImportPositionHashPresent(0,539780712)?g=!0:PE.isImportPositionHashPresent(0,614375123)&&(e=g=!0),g)&&t.push({type:"BitRAT",version:"",details:e?"Tor":""}),(0===t.length&&PE.isImportPositionHashPresent(0,2568978330)&&PE.isImportPositionHashPresent(1,882244769)||PE.isImportPositionHashPresent(0,2105065721)&&PE.isImportPositionHashPresent(1,1266076431))&&t.push({type:"Furax RAT",version:"",details:""}),0===t.length&&PE.isImportPositionHashPresent(0,1113591535)&&PE.isSignatureInSectionPresent(0,"'Octopus'")&&t.push({type:"Octopus RAT",version:"",details:""}),(0===t.length&&1===PE_Cached.numberOfUnmanagedImports&&PE.isImportPositionHashPresent(0,111168790)||4<PE_Cached.numberOfUnmanagedImports&&PE.isImportPositionHashPresent(0,2803470731)&&PE.isImportPositionHashPresent(-1,2676805574))&&t.push({type:"Biorante",version:"1.X",details:""}),0===t.length&&PE.isImportPositionHashPresent(0,3006365830)&&PE.isImportPositionHashPresent(1,1033520080)&&PE.isImportPositionHashPresent(7,4088555341)&&t.push({type:"Smart RAT",version:"1.0.X",details:""}),0===t.length&&1===PE_Cached.numberOfUnmanagedImports&&PE.isImportPositionHashPresent(0,459450912)&&t.push({type:"Ace RAT",version:"1.X",details:""}),0===t.length&&1===PE_Cached.numberOfUnmanagedImports&&PE_Cached.isRichSignaturePresent&&PE.isImportPositionHashPresent(0,762281608)&&t.push({type:"Aquates RAT",version:"1.0",details:""}),0===t.length&&"ï¿½ï¿½50"===PE.section[0].Name&&t.push({type:"Exception RAT",version:"1.0",details:""}),0===t.length&&!PE_Cached.isRichSignaturePresent&&PE.isImportPositionHashPresent(0,3174455850)&&(g="",PE.isImportPositionHashPresent(1,248520579)?g="1.0":PE.isImportPositionHashPresent(1,4023696997)?g="1.2-1.3":PE.isImportPositionHashPresent(1,1477655120)&&(g="1.4-1.5.X"),g)&&t.push({type:"Bozok RAT",version:g,details:""}),0!==t.length||PE_Cached.isRichSignaturePresent||(e="",PE.isImportPositionHashPresent(0,4229993903)?e="0.0.1":PE.isImportPositionHashPresent(0,2345157726)&&(e="0.2"),e&&PE.isSignatureInSectionPresent(0,"'Aqua'")&&t.push({type:"Aqua RAT",version:e,details:""})),(0===t.length&&PE.isImportPositionHashPresent(0,2422509254)&&PE.isImportPositionHashPresent(1,429705986)&&PE.isImportPositionHashPresent(2,1269980471)||PE.isImportPositionHashPresent(0,1102215680)&&PE.isImportPositionHashPresent(1,1453959748)&&PE.isImportPositionHashPresent(2,1269980471)||PE.isImportPositionHashPresent(0,3326727301)&&PE.isImportPositionHashPresent(1,4075199253)&&PE.isImportPositionHashPresent(2,1269980471)||PE.isImportPositionHashPresent(0,3799964685)&&PE.isImportPositionHashPresent(1,497382926)&&PE.isImportPositionHashPresent(2,1115135284)||PE.isImportPositionHashPresent(0,1033520080)&&PE.isImportPositionHashPresent(1,3264172003)&&PE.isImportPositionHashPresent(2,1562107340)||PE.isImportPositionHashPresent(0,4084592131)&&PE.isImportPositionHashPresent(1,1033520080)&&PE.isImportPositionHashPresent(2,3264172003)&&(PE.isImportPositionHashPresent(3,1562107340)||PE.isImportPositionHashPresent(3,2719365508)))&&t.push({type:"Babylon RAT",version:"",details:""}),0===t.length&&PE.isImportPositionHashPresent(0,1369422246)&&PE.isImportPositionHashPresent(1,1767251880)&&PE.isImportPositionHashPresent(2,3869932869)&&t.push({type:"Sinique RAT",version:"1.0",details:""}),0===t.length&&PE.isImportPositionHashPresent(1,1562107340)&&(g="",PE.isImportPositionHashPresent(0,4195209253)?g="1.2.X":PE.isImportPositionHashPresent(0,2017850469)&&(g="1.4"),g)&&t.push({type:"NetWire RAT",version:g,details:""}),0===t.length&&PE.isImportPositionHashPresent(0,4066093359)&&PE.isImportPositionHashPresent(1,4148211208)&&PE.isImportPositionHashPresent(2,3124367634)&&t.push({type:"Remcos RAT",version:"",details:""}),0===t.length&&!PE_Cached.isRichSignaturePresent&&20===PE_Cached.numberOfUnmanagedImports&&PE.isImportPositionHashPresent(9,1376149806)&&PE.isImportPositionHashPresent(16,4088555341)&&PE.isImportPositionHashPresent(19,2883482619)&&t.push({type:"Daleth RAT",version:"1.0",details:""}),0===t.length&&!PE_Cached.isRichSignaturePresent&&31===PE_Cached.numberOfUnmanagedImports&&PE.isImportPositionHashPresent(0,3479190141)&&PE.isImportPositionHashPresent(-1,33665726)&&PE.isImportPositionHashPresent(-1,1017252086)&&t.push({type:"Syndrome RAT",version:"4.3.X",details:""}),0===t.length&&!PE_Cached.isRichSignaturePresent&&PE.isTLSPresent()&&(PE.isImportPositionHashPresent(18,3286185320)&&PE.isSignatureInSectionPresent(0,"'lock_text'00")||PE.isImportPositionHashPresent(4,3286185320)&&PE.isImportPositionHashPresent(5,1646979334))&&t.push({type:"Amp WinLocker",version:"Sumhex Edition",details:""})
for(var P=["TVoAAAAAA","TVqQAA","TVpQAA","TVp4AA"],p=0;p<P.length;p++){var E=P[p]
if(validateGlobalUnicodeString(E)||validateSignature("'"+E+"'")){t.push({type:"Base64 payload",version:"",details:i})
break}}(PE_Cached.isDotNet&&("stub"===PE_Cached.nameOfNetAssemblyName.toLowerCase()||0===PE_Cached.nameOfNetModuleName.toLowerCase().indexOf("stub.")||-1!==PE_Cached.nameOfNetAssemblyName.toLowerCase().indexOf("crypted")||-1!==PE_Cached.nameOfNetModuleName.toLowerCase().indexOf("crypted")||-1!==PE_Cached.nameOfNetAssemblyName.toLowerCase().indexOf("payload")||-1!==PE_Cached.nameOfNetModuleName.toLowerCase().indexOf("payload")||isNameObfuscated(PE_Cached.nameOfNetAssemblyName)||isNameObfuscated(PE_Cached.nameOfNetModuleName)||/(^tmp|\.tmp$)/.test(PE_Cached.nameOfNetModuleName))||0===PE.getVersionStringInfo("OriginalFilename").toLowerCase().indexOf("stub.")||0===PE.getVersionStringInfo("InternalName").toLowerCase().indexOf("stub.")||(function(){for(var e=["Comments","CompanyName","FileDescription","ProductName","LegalCopyright","LegalTrademarks","OriginalFilename","InternalName"],t=0;t<e.length;t++)if(isNameObfuscated(PE.getVersionStringInfo(e[t])))return 1})())&&t.push({type:"Anomalous build info",version:"",details:i}),(PE.isResourceNamePresentExp(/^(STUB|SERVER)(\.[A-Z]{3})?$/)||PE.isResourceNamePresentExp(/(PAYLOAD|SHELLCODE|INJECT|CRYPTED)/))&&t.push({type:"Anomalous resources",version:"",details:i})
for(var m=0;m<t.length;m++){var h=t[m]
_setResult("~malware",h.type,h.version,h.details)}}