function detect(){if(PE.isNet()&&PE.isNetGlobalCctorPresent()&&3<=PE.getNumberOfSections()&&PE.isNetObjectPresent("SuppressIldasmAttribute")&&PE.isNetObjectPresent("kernel32")&&PE.isNetObjectPresent("get_IsAttached")&&PE.isNetObjectPresent("OpCodes")){for(var e="%% %% %% %% %% %% %% %% 00",t=PE.getSize()-PE.getOverlaySize(),s="00",r=0;r<12;r++)s+=e
var i=PE.section[0]
PE.isSignaturePresent(i.FileOffset,t,"'<Module>' 00"+e)&&PE.isSignaturePresent(i.FileOffset,t,s)&&(sVersion="3.X",bDetected=!0),bDetected&&(PE.isSignaturePresent(i.FileOffset,t,generateUnicodeSignatureMask("Program will be terminated."))&&(sOptions="Resources protection"),".vmp"===(i=PE.getSectionNameCollision("0","1"))?sVersion="2.X-3.X":i&&(sOptions+=(0!=sOptions.length?" + ":"")+"Custom sections"),bDetected=bDetected&&!PE.isNetObjectPresent("VMProtect"))}return result()}function generateUnicodeSignatureMask(e){for(var t="",s=0;s<e.length;s++)t+=(0!=s?"00":"")+"'"+e[s]+"'"
return t}meta("protector","VMProtect")