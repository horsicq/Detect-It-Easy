function detect(){if(!PE.isNet()&&!PE.is64()){for(var e="",t=0,s=0,i=0,r=0,P=0,o=0,E=0,n=PE.OffsetToVA(PE.getEntryPointOffset()),c=0;c<1e3;)c++,"CLC"==(e=-1!=(e=PE.getDisasmString(n)).indexOf(" ")?e.slice(0,e.indexOf(" ")):e)&&t++,"STC"==e&&s++,"MOVSX"==e&&0,"MOVZX"==e&&i++,"SUB"==e&&r++,"IMUL"==e&&P++,"BT"!=e&&"BTR"!=e&&"BTS"!=e&&"BTC"!=e||o++,"BSF"!=e&&"BSR"!=e&&"BSWAP"!=e||E++,n=PE.getDisasmNextAddress(n)
return(bDetected=0<t&&0<s&&0!=i&&(P<r||0==r&&0==P)&&0==o&&0==E?!0:bDetected)||(PE.compareEP("6A6068........E8........BF94")||PE.isImportPositionHashPresent(0,3781729660))&&(sVersion="2.X",bDetected=1),result()}}meta("protector","PELock")